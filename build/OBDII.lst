ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 6
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"OBDII.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.global	c_dt
  20              		.section	.bss.c_dt,"aw",%nobits
  21              		.align	2
  24              	c_dt:
  25 0000 00000000 		.space	8
  25      00000000 
  26              		.global	c_rcv_flag
  27              		.section	.bss.c_rcv_flag,"aw",%nobits
  30              	c_rcv_flag:
  31 0000 00       		.space	1
  32              		.global	flasg_t
  33              		.section	.bss.flasg_t,"aw",%nobits
  36              	flasg_t:
  37 0000 00       		.space	1
  38              		.global	init_obd
  39              		.section	.bss.init_obd,"aw",%nobits
  40              		.align	1
  43              	init_obd:
  44 0000 0000     		.space	2
  45              		.global	obd_turn_on
  46              		.section	.bss.obd_turn_on,"aw",%nobits
  49              	obd_turn_on:
  50 0000 00       		.space	1
  51              		.global	obd_data
  52              		.section	.bss.obd_data,"aw",%nobits
  53              		.align	2
  56              	obd_data:
  57 0000 00000000 		.space	250
  57      00000000 
  57      00000000 
  57      00000000 
  57      00000000 
  58              		.global	obd_count
  59              		.section	.bss.obd_count,"aw",%nobits
  62              	obd_count:
  63 0000 00       		.space	1
  64              		.global	OBD_RCV_T
  65              		.section	.bss.OBD_RCV_T,"aw",%nobits
  68              	OBD_RCV_T:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 2


  69 0000 00       		.space	1
  70              		.section	.text.can_send,"ax",%progbits
  71              		.align	1
  72              		.global	can_send
  73              		.syntax unified
  74              		.thumb
  75              		.thumb_func
  77              	can_send:
  78              	.LFB135:
  79              		.file 1 "User/Src/OBDII.c"
   1:User/Src/OBDII.c **** 
   2:User/Src/OBDII.c **** #include "OBDII.h"
   3:User/Src/OBDII.c **** 
   4:User/Src/OBDII.c **** #include <stdint.h>
   5:User/Src/OBDII.c **** 
   6:User/Src/OBDII.c **** #include "stm32f4xx.h"
   7:User/Src/OBDII.c **** #include "stm32f4xx_rcc.h"
   8:User/Src/OBDII.c **** #include "stm32f4xx_can.h"
   9:User/Src/OBDII.c **** #include "stm32f4xx_usart.h"
  10:User/Src/OBDII.c **** #include "stm32f4xx_gpio.h"
  11:User/Src/OBDII.c **** #include "stm32f4xx_tim.h"
  12:User/Src/OBDII.c **** #include "stm32f4xx_it.h"
  13:User/Src/OBDII.c **** 
  14:User/Src/OBDII.c **** #include "misc.h"
  15:User/Src/OBDII.c **** 
  16:User/Src/OBDII.c **** #include "FreeRTOS.h"
  17:User/Src/OBDII.c **** #include "task.h"
  18:User/Src/OBDII.c **** 
  19:User/Src/OBDII.c **** uint8_t c_dt[8] = {0};
  20:User/Src/OBDII.c **** uint8_t c_rcv_flag = 0;
  21:User/Src/OBDII.c **** uint8_t flasg_t = 0;
  22:User/Src/OBDII.c **** uint16_t init_obd = 0;
  23:User/Src/OBDII.c **** uint8_t obd_turn_on = 0;
  24:User/Src/OBDII.c **** uint8_t obd_data[obd_size_buf] = {0};
  25:User/Src/OBDII.c **** uint8_t obd_count = 0;
  26:User/Src/OBDII.c **** uint8_t OBD_RCV_T = 0;
  27:User/Src/OBDII.c **** 
  28:User/Src/OBDII.c **** 
  29:User/Src/OBDII.c **** /*******************************************************************************
  30:User/Src/OBDII.c **** * Function Name  : can_send
  31:User/Src/OBDII.c **** * Description    : send data through can protocol (ISO 15765)
  32:User/Src/OBDII.c **** * Input          : data (data),data_l (data length),id
  33:User/Src/OBDII.c **** * Output         : None
  34:User/Src/OBDII.c **** * Return         : None
  35:User/Src/OBDII.c **** *******************************************************************************/			
  36:User/Src/OBDII.c **** 	
  37:User/Src/OBDII.c **** uint8_t can_send(uint16_t id , uint8_t data_l,uint8_t *data)	
  38:User/Src/OBDII.c **** {
  80              		.loc 1 38 1
  81              		.cfi_startproc
  82              		@ args = 0, pretend = 0, frame = 32
  83              		@ frame_needed = 1, uses_anonymous_args = 0
  84 0000 80B5     		push	{r7, lr}
  85              	.LCFI0:
  86              		.cfi_def_cfa_offset 8
  87              		.cfi_offset 7, -8
  88              		.cfi_offset 14, -4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 3


  89 0002 88B0     		sub	sp, sp, #32
  90              	.LCFI1:
  91              		.cfi_def_cfa_offset 40
  92 0004 00AF     		add	r7, sp, #0
  93              	.LCFI2:
  94              		.cfi_def_cfa_register 7
  95 0006 0346     		mov	r3, r0
  96 0008 3A60     		str	r2, [r7]
  97 000a FB80     		strh	r3, [r7, #6]	@ movhi
  98 000c 0B46     		mov	r3, r1
  99 000e 7B71     		strb	r3, [r7, #5]
  39:User/Src/OBDII.c ****     uint8_t a;
  40:User/Src/OBDII.c ****     uint8_t t_out = 0;
 100              		.loc 1 40 13
 101 0010 0023     		movs	r3, #0
 102 0012 FB77     		strb	r3, [r7, #31]
  41:User/Src/OBDII.c ****     CanTxMsg TxMessage;
  42:User/Src/OBDII.c **** 
  43:User/Src/OBDII.c ****     a = 0;
 103              		.loc 1 43 7
 104 0014 0023     		movs	r3, #0
 105 0016 BB77     		strb	r3, [r7, #30]
  44:User/Src/OBDII.c **** 
  45:User/Src/OBDII.c ****     TxMessage.StdId = id;
 106              		.loc 1 45 21
 107 0018 FB88     		ldrh	r3, [r7, #6]
 108 001a BB60     		str	r3, [r7, #8]
  46:User/Src/OBDII.c ****     TxMessage.RTR = CAN_RTR_DATA;
 109              		.loc 1 46 19
 110 001c 0023     		movs	r3, #0
 111 001e 7B74     		strb	r3, [r7, #17]
  47:User/Src/OBDII.c ****     TxMessage.IDE = CAN_ID_STD;
 112              		.loc 1 47 19
 113 0020 0023     		movs	r3, #0
 114 0022 3B74     		strb	r3, [r7, #16]
  48:User/Src/OBDII.c ****     TxMessage.DLC = data_l;
 115              		.loc 1 48 19
 116 0024 7B79     		ldrb	r3, [r7, #5]
 117 0026 BB74     		strb	r3, [r7, #18]
  49:User/Src/OBDII.c ****     TxMessage.Data[0] = data[0];
 118              		.loc 1 49 29
 119 0028 3B68     		ldr	r3, [r7]
 120 002a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 121              		.loc 1 49 23
 122 002c FB74     		strb	r3, [r7, #19]
  50:User/Src/OBDII.c ****     TxMessage.Data[1] = data[1];
 123              		.loc 1 50 23
 124 002e 3B68     		ldr	r3, [r7]
 125 0030 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 126 0032 3B75     		strb	r3, [r7, #20]
  51:User/Src/OBDII.c ****     TxMessage.Data[2] = data[2];
 127              		.loc 1 51 23
 128 0034 3B68     		ldr	r3, [r7]
 129 0036 9B78     		ldrb	r3, [r3, #2]	@ zero_extendqisi2
 130 0038 7B75     		strb	r3, [r7, #21]
  52:User/Src/OBDII.c ****     TxMessage.Data[3] = data[3];
 131              		.loc 1 52 23
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 4


 132 003a 3B68     		ldr	r3, [r7]
 133 003c DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 134 003e BB75     		strb	r3, [r7, #22]
  53:User/Src/OBDII.c ****     TxMessage.Data[4] = data[4];
 135              		.loc 1 53 23
 136 0040 3B68     		ldr	r3, [r7]
 137 0042 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 138 0044 FB75     		strb	r3, [r7, #23]
  54:User/Src/OBDII.c ****     TxMessage.Data[5] = data[5];
 139              		.loc 1 54 23
 140 0046 3B68     		ldr	r3, [r7]
 141 0048 5B79     		ldrb	r3, [r3, #5]	@ zero_extendqisi2
 142 004a 3B76     		strb	r3, [r7, #24]
  55:User/Src/OBDII.c ****     TxMessage.Data[6] = data[6];
 143              		.loc 1 55 23
 144 004c 3B68     		ldr	r3, [r7]
 145 004e 9B79     		ldrb	r3, [r3, #6]	@ zero_extendqisi2
 146 0050 7B76     		strb	r3, [r7, #25]
  56:User/Src/OBDII.c ****     TxMessage.Data[7] = data[7];	
 147              		.loc 1 56 23
 148 0052 3B68     		ldr	r3, [r7]
 149 0054 DB79     		ldrb	r3, [r3, #7]	@ zero_extendqisi2
 150 0056 BB76     		strb	r3, [r7, #26]
  57:User/Src/OBDII.c ****         
  58:User/Src/OBDII.c ****     a=CAN_Transmit(CAN1, &TxMessage);
 151              		.loc 1 58 7
 152 0058 07F10803 		add	r3, r7, #8
 153 005c 1946     		mov	r1, r3
 154 005e 1448     		ldr	r0, .L8
 155 0060 FFF7FEFF 		bl	CAN_Transmit
 156 0064 0346     		mov	r3, r0
 157 0066 BB77     		strb	r3, [r7, #30]
  59:User/Src/OBDII.c **** 
  60:User/Src/OBDII.c ****     while(((CAN_TransmitStatus(CAN1, a) != CANTXOK))&&(t_out<100))
 158              		.loc 1 60 10
 159 0068 05E0     		b	.L2
 160              	.L4:
  61:User/Src/OBDII.c ****     {
  62:User/Src/OBDII.c ****         vTaskDelay(3);
 161              		.loc 1 62 9
 162 006a 0320     		movs	r0, #3
 163 006c FFF7FEFF 		bl	vTaskDelay
  63:User/Src/OBDII.c ****         t_out++;
 164              		.loc 1 63 14
 165 0070 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 166 0072 0133     		adds	r3, r3, #1
 167 0074 FB77     		strb	r3, [r7, #31]
 168              	.L2:
  60:User/Src/OBDII.c ****     {
 169              		.loc 1 60 13
 170 0076 BB7F     		ldrb	r3, [r7, #30]	@ zero_extendqisi2
 171 0078 1946     		mov	r1, r3
 172 007a 0D48     		ldr	r0, .L8
 173 007c FFF7FEFF 		bl	CAN_TransmitStatus
 174 0080 0346     		mov	r3, r0
  60:User/Src/OBDII.c ****     {
 175              		.loc 1 60 10
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 5


 176 0082 012B     		cmp	r3, #1
 177 0084 02D0     		beq	.L3
  60:User/Src/OBDII.c ****     {
 178              		.loc 1 60 53 discriminator 1
 179 0086 FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 180 0088 632B     		cmp	r3, #99
 181 008a EED9     		bls	.L4
 182              	.L3:
  64:User/Src/OBDII.c ****     }
  65:User/Src/OBDII.c ****     if(t_out==100)
 183              		.loc 1 65 7
 184 008c FB7F     		ldrb	r3, [r7, #31]	@ zero_extendqisi2
 185 008e 642B     		cmp	r3, #100
 186 0090 06D1     		bne	.L5
  66:User/Src/OBDII.c ****     {
  67:User/Src/OBDII.c ****         CAN_CancelTransmit(CAN1, a);
 187              		.loc 1 67 9
 188 0092 BB7F     		ldrb	r3, [r7, #30]	@ zero_extendqisi2
 189 0094 1946     		mov	r1, r3
 190 0096 0648     		ldr	r0, .L8
 191 0098 FFF7FEFF 		bl	CAN_CancelTransmit
  68:User/Src/OBDII.c ****         return 0;	
 192              		.loc 1 68 16
 193 009c 0023     		movs	r3, #0
 194 009e 03E0     		b	.L7
 195              	.L5:
  69:User/Src/OBDII.c ****     }	
  70:User/Src/OBDII.c ****     c_rcv_flag=0;
 196              		.loc 1 70 15
 197 00a0 044B     		ldr	r3, .L8+4
 198 00a2 0022     		movs	r2, #0
 199 00a4 1A70     		strb	r2, [r3]
  71:User/Src/OBDII.c ****     return 1;	
 200              		.loc 1 71 12
 201 00a6 0123     		movs	r3, #1
 202              	.L7:
  72:User/Src/OBDII.c **** }
 203              		.loc 1 72 1 discriminator 1
 204 00a8 1846     		mov	r0, r3
 205 00aa 2037     		adds	r7, r7, #32
 206              	.LCFI3:
 207              		.cfi_def_cfa_offset 8
 208 00ac BD46     		mov	sp, r7
 209              	.LCFI4:
 210              		.cfi_def_cfa_register 13
 211              		@ sp needed
 212 00ae 80BD     		pop	{r7, pc}
 213              	.L9:
 214              		.align	2
 215              	.L8:
 216 00b0 00640040 		.word	1073767424
 217 00b4 00000000 		.word	c_rcv_flag
 218              		.cfi_endproc
 219              	.LFE135:
 221              		.section	.text.can_rcv,"ax",%progbits
 222              		.align	1
 223              		.global	can_rcv
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 6


 224              		.syntax unified
 225              		.thumb
 226              		.thumb_func
 228              	can_rcv:
 229              	.LFB136:
  73:User/Src/OBDII.c **** 
  74:User/Src/OBDII.c **** 
  75:User/Src/OBDII.c **** /*******************************************************************************
  76:User/Src/OBDII.c **** * Function Name  : can_rcv
  77:User/Src/OBDII.c **** * Description    : receive data through can protocol (ISO 15765)
  78:User/Src/OBDII.c **** * Input          : data_l(data length),data(data)
  79:User/Src/OBDII.c **** * Output         : None
  80:User/Src/OBDII.c **** * Return         : None
  81:User/Src/OBDII.c **** *******************************************************************************/	
  82:User/Src/OBDII.c **** 
  83:User/Src/OBDII.c **** uint8_t can_rcv(uint8_t *data_l,uint8_t *data)	
  84:User/Src/OBDII.c **** {
 230              		.loc 1 84 1
 231              		.cfi_startproc
 232              		@ args = 0, pretend = 0, frame = 16
 233              		@ frame_needed = 1, uses_anonymous_args = 0
 234 0000 80B5     		push	{r7, lr}
 235              	.LCFI5:
 236              		.cfi_def_cfa_offset 8
 237              		.cfi_offset 7, -8
 238              		.cfi_offset 14, -4
 239 0002 84B0     		sub	sp, sp, #16
 240              	.LCFI6:
 241              		.cfi_def_cfa_offset 24
 242 0004 00AF     		add	r7, sp, #0
 243              	.LCFI7:
 244              		.cfi_def_cfa_register 7
 245 0006 7860     		str	r0, [r7, #4]
 246 0008 3960     		str	r1, [r7]
  85:User/Src/OBDII.c ****     uint8_t t_out=0;
 247              		.loc 1 85 13
 248 000a 0023     		movs	r3, #0
 249 000c FB73     		strb	r3, [r7, #15]
  86:User/Src/OBDII.c ****     uint8_t i=0;
 250              		.loc 1 86 13
 251 000e 0023     		movs	r3, #0
 252 0010 BB73     		strb	r3, [r7, #14]
  87:User/Src/OBDII.c **** 
  88:User/Src/OBDII.c ****     while((!c_rcv_flag)&&(t_out<100))
 253              		.loc 1 88 10
 254 0012 05E0     		b	.L11
 255              	.L13:
  89:User/Src/OBDII.c ****     {
  90:User/Src/OBDII.c ****         vTaskDelay(40);
 256              		.loc 1 90 9
 257 0014 2820     		movs	r0, #40
 258 0016 FFF7FEFF 		bl	vTaskDelay
  91:User/Src/OBDII.c ****         t_out++;
 259              		.loc 1 91 14
 260 001a FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 261 001c 0133     		adds	r3, r3, #1
 262 001e FB73     		strb	r3, [r7, #15]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 7


 263              	.L11:
  88:User/Src/OBDII.c ****     {
 264              		.loc 1 88 12
 265 0020 164B     		ldr	r3, .L19
 266 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  88:User/Src/OBDII.c ****     {
 267              		.loc 1 88 10
 268 0024 002B     		cmp	r3, #0
 269 0026 02D1     		bne	.L12
  88:User/Src/OBDII.c ****     {
 270              		.loc 1 88 24 discriminator 1
 271 0028 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 272 002a 632B     		cmp	r3, #99
 273 002c F2D9     		bls	.L13
 274              	.L12:
  92:User/Src/OBDII.c ****     }
  93:User/Src/OBDII.c **** 
  94:User/Src/OBDII.c ****     if (t_out==100)
 275              		.loc 1 94 8
 276 002e FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 277 0030 642B     		cmp	r3, #100
 278 0032 01D1     		bne	.L14
  95:User/Src/OBDII.c ****             return 0;
 279              		.loc 1 95 20
 280 0034 0023     		movs	r3, #0
 281 0036 1DE0     		b	.L15
 282              	.L14:
  96:User/Src/OBDII.c **** 
  97:User/Src/OBDII.c ****     if(c_dt[1]==0x41)
 283              		.loc 1 97 12
 284 0038 114B     		ldr	r3, .L19+4
 285 003a 5B78     		ldrb	r3, [r3, #1]	@ zero_extendqisi2
 286              		.loc 1 97 7
 287 003c 412B     		cmp	r3, #65
 288 003e 18D1     		bne	.L16
  98:User/Src/OBDII.c ****     {
  99:User/Src/OBDII.c ****         for(i=1; i<=c_dt[0]; i++)
 289              		.loc 1 99 14
 290 0040 0123     		movs	r3, #1
 291 0042 BB73     		strb	r3, [r7, #14]
 292              		.loc 1 99 9
 293 0044 0AE0     		b	.L17
 294              	.L18:
 100:User/Src/OBDII.c ****         {
 101:User/Src/OBDII.c ****             data[i-1] = c_dt[i];
 295              		.loc 1 101 29 discriminator 3
 296 0046 BA7B     		ldrb	r2, [r7, #14]	@ zero_extendqisi2
 297              		.loc 1 101 17 discriminator 3
 298 0048 BB7B     		ldrb	r3, [r7, #14]	@ zero_extendqisi2
 299 004a 013B     		subs	r3, r3, #1
 300 004c 3968     		ldr	r1, [r7]
 301 004e 0B44     		add	r3, r3, r1
 302              		.loc 1 101 29 discriminator 3
 303 0050 0B49     		ldr	r1, .L19+4
 304 0052 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 305              		.loc 1 101 23 discriminator 3
 306 0054 1A70     		strb	r2, [r3]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 8


  99:User/Src/OBDII.c ****         {
 307              		.loc 1 99 31 discriminator 3
 308 0056 BB7B     		ldrb	r3, [r7, #14]	@ zero_extendqisi2
 309 0058 0133     		adds	r3, r3, #1
 310 005a BB73     		strb	r3, [r7, #14]
 311              	.L17:
  99:User/Src/OBDII.c ****         {
 312              		.loc 1 99 25 discriminator 1
 313 005c 084B     		ldr	r3, .L19+4
 314 005e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  99:User/Src/OBDII.c ****         {
 315              		.loc 1 99 9 discriminator 1
 316 0060 BA7B     		ldrb	r2, [r7, #14]	@ zero_extendqisi2
 317 0062 9A42     		cmp	r2, r3
 318 0064 EFD9     		bls	.L18
 102:User/Src/OBDII.c ****         }
 103:User/Src/OBDII.c **** 
 104:User/Src/OBDII.c ****         data_l[0] = c_dt[0];
 319              		.loc 1 104 25
 320 0066 064B     		ldr	r3, .L19+4
 321 0068 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 322              		.loc 1 104 19
 323 006a 7B68     		ldr	r3, [r7, #4]
 324 006c 1A70     		strb	r2, [r3]
 105:User/Src/OBDII.c ****         return 1;
 325              		.loc 1 105 16
 326 006e 0123     		movs	r3, #1
 327 0070 00E0     		b	.L15
 328              	.L16:
 106:User/Src/OBDII.c ****     }
 107:User/Src/OBDII.c **** 
 108:User/Src/OBDII.c ****     return 0;
 329              		.loc 1 108 12
 330 0072 0023     		movs	r3, #0
 331              	.L15:
 109:User/Src/OBDII.c **** }
 332              		.loc 1 109 1
 333 0074 1846     		mov	r0, r3
 334 0076 1037     		adds	r7, r7, #16
 335              	.LCFI8:
 336              		.cfi_def_cfa_offset 8
 337 0078 BD46     		mov	sp, r7
 338              	.LCFI9:
 339              		.cfi_def_cfa_register 13
 340              		@ sp needed
 341 007a 80BD     		pop	{r7, pc}
 342              	.L20:
 343              		.align	2
 344              	.L19:
 345 007c 00000000 		.word	c_rcv_flag
 346 0080 00000000 		.word	c_dt
 347              		.cfi_endproc
 348              	.LFE136:
 350              		.section	.text.K_line_RCV,"ax",%progbits
 351              		.align	1
 352              		.global	K_line_RCV
 353              		.syntax unified
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 9


 354              		.thumb
 355              		.thumb_func
 357              	K_line_RCV:
 358              	.LFB137:
 110:User/Src/OBDII.c **** 
 111:User/Src/OBDII.c **** 
 112:User/Src/OBDII.c **** /*******************************************************************************
 113:User/Src/OBDII.c **** * Function Name  : K_line_RCV
 114:User/Src/OBDII.c **** * Description    : receive data through serial protocol (ISO 9141-2)
 115:User/Src/OBDII.c **** * Input          : rsp (response address to store) ,size(size of recive to store)
 116:User/Src/OBDII.c **** * Output         : None
 117:User/Src/OBDII.c **** * Return         : None
 118:User/Src/OBDII.c **** *******************************************************************************/		
 119:User/Src/OBDII.c **** 	
 120:User/Src/OBDII.c **** void K_line_RCV(uint8_t *rsp,uint8_t *size)	
 121:User/Src/OBDII.c **** {
 359              		.loc 1 121 1
 360              		.cfi_startproc
 361              		@ args = 0, pretend = 0, frame = 16
 362              		@ frame_needed = 1, uses_anonymous_args = 0
 363 0000 80B5     		push	{r7, lr}
 364              	.LCFI10:
 365              		.cfi_def_cfa_offset 8
 366              		.cfi_offset 7, -8
 367              		.cfi_offset 14, -4
 368 0002 84B0     		sub	sp, sp, #16
 369              	.LCFI11:
 370              		.cfi_def_cfa_offset 24
 371 0004 00AF     		add	r7, sp, #0
 372              	.LCFI12:
 373              		.cfi_def_cfa_register 7
 374 0006 7860     		str	r0, [r7, #4]
 375 0008 3960     		str	r1, [r7]
 122:User/Src/OBDII.c **** 	uint32_t timeout=0;
 376              		.loc 1 122 11
 377 000a 0023     		movs	r3, #0
 378 000c BB60     		str	r3, [r7, #8]
 123:User/Src/OBDII.c **** 	int i=0;
 379              		.loc 1 123 6
 380 000e 0023     		movs	r3, #0
 381 0010 FB60     		str	r3, [r7, #12]
 124:User/Src/OBDII.c **** 
 125:User/Src/OBDII.c **** 	if((dif_count_obd())&(obd_count==(obd_data[0]&0xf)+4))
 382              		.loc 1 125 6
 383 0012 FFF7FEFF 		bl	dif_count_obd
 384 0016 0346     		mov	r3, r0
 385 0018 1A46     		mov	r2, r3
 386              		.loc 1 125 33
 387 001a 584B     		ldr	r3, .L38
 388 001c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 389 001e 1946     		mov	r1, r3
 390              		.loc 1 125 44
 391 0020 574B     		ldr	r3, .L38+4
 392 0022 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 393              		.loc 1 125 47
 394 0024 03F00F03 		and	r3, r3, #15
 395              		.loc 1 125 52
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 10


 396 0028 0433     		adds	r3, r3, #4
 397              		.loc 1 125 33
 398 002a 9942     		cmp	r1, r3
 399 002c 0CBF     		ite	eq
 400 002e 0123     		moveq	r3, #1
 401 0030 0023     		movne	r3, #0
 402 0032 DBB2     		uxtb	r3, r3
 403              		.loc 1 125 22
 404 0034 1340     		ands	r3, r3, r2
 405              		.loc 1 125 4
 406 0036 002B     		cmp	r3, #0
 407 0038 2CD0     		beq	.L22
 126:User/Src/OBDII.c **** 	{	
 127:User/Src/OBDII.c ****         size[0]=obd_data[0]&0xf;
 408              		.loc 1 127 25
 409 003a 514B     		ldr	r3, .L38+4
 410 003c 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 411              		.loc 1 127 28
 412 003e 03F00F03 		and	r3, r3, #15
 413 0042 DAB2     		uxtb	r2, r3
 414              		.loc 1 127 16
 415 0044 3B68     		ldr	r3, [r7]
 416 0046 1A70     		strb	r2, [r3]
 128:User/Src/OBDII.c ****         for(i=0; i<size[0]; i++)
 417              		.loc 1 128 14
 418 0048 0023     		movs	r3, #0
 419 004a FB60     		str	r3, [r7, #12]
 420              		.loc 1 128 9
 421 004c 0AE0     		b	.L23
 422              	.L24:
 129:User/Src/OBDII.c ****             rsp[i] = obd_data[i+3];
 423              		.loc 1 129 32 discriminator 3
 424 004e FB68     		ldr	r3, [r7, #12]
 425 0050 DA1C     		adds	r2, r3, #3
 426              		.loc 1 129 16 discriminator 3
 427 0052 FB68     		ldr	r3, [r7, #12]
 428 0054 7968     		ldr	r1, [r7, #4]
 429 0056 0B44     		add	r3, r3, r1
 430              		.loc 1 129 30 discriminator 3
 431 0058 4949     		ldr	r1, .L38+4
 432 005a 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 433              		.loc 1 129 20 discriminator 3
 434 005c 1A70     		strb	r2, [r3]
 128:User/Src/OBDII.c ****         for(i=0; i<size[0]; i++)
 435              		.loc 1 128 30 discriminator 3
 436 005e FB68     		ldr	r3, [r7, #12]
 437 0060 0133     		adds	r3, r3, #1
 438 0062 FB60     		str	r3, [r7, #12]
 439              	.L23:
 128:User/Src/OBDII.c ****         for(i=0; i<size[0]; i++)
 440              		.loc 1 128 24 discriminator 1
 441 0064 3B68     		ldr	r3, [r7]
 442 0066 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 443 0068 1A46     		mov	r2, r3
 128:User/Src/OBDII.c ****         for(i=0; i<size[0]; i++)
 444              		.loc 1 128 9 discriminator 1
 445 006a FB68     		ldr	r3, [r7, #12]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 11


 446 006c 9342     		cmp	r3, r2
 447 006e EEDB     		blt	.L24
 130:User/Src/OBDII.c ****             
 131:User/Src/OBDII.c ****         for(i=0; i<obd_size_buf; i++)
 448              		.loc 1 131 14
 449 0070 0023     		movs	r3, #0
 450 0072 FB60     		str	r3, [r7, #12]
 451              		.loc 1 131 9
 452 0074 07E0     		b	.L25
 453              	.L26:
 132:User/Src/OBDII.c ****             obd_data[i] = 0;
 454              		.loc 1 132 25 discriminator 3
 455 0076 424A     		ldr	r2, .L38+4
 456 0078 FB68     		ldr	r3, [r7, #12]
 457 007a 1344     		add	r3, r3, r2
 458 007c 0022     		movs	r2, #0
 459 007e 1A70     		strb	r2, [r3]
 131:User/Src/OBDII.c ****             obd_data[i] = 0;
 460              		.loc 1 131 35 discriminator 3
 461 0080 FB68     		ldr	r3, [r7, #12]
 462 0082 0133     		adds	r3, r3, #1
 463 0084 FB60     		str	r3, [r7, #12]
 464              	.L25:
 131:User/Src/OBDII.c ****             obd_data[i] = 0;
 465              		.loc 1 131 9 discriminator 1
 466 0086 FB68     		ldr	r3, [r7, #12]
 467 0088 F92B     		cmp	r3, #249
 468 008a F4DD     		ble	.L26
 133:User/Src/OBDII.c ****             obd_count = 0;
 469              		.loc 1 133 23
 470 008c 3B4B     		ldr	r3, .L38
 471 008e 0022     		movs	r2, #0
 472 0090 1A70     		strb	r2, [r3]
 473 0092 67E0     		b	.L27
 474              	.L22:
 134:User/Src/OBDII.c **** 	}else if((dif_count_obd())&((obd_data[0]==0x80)|(obd_data[3]==obd_count-5))){
 475              		.loc 1 134 12
 476 0094 FFF7FEFF 		bl	dif_count_obd
 477 0098 0346     		mov	r3, r0
 478 009a 1946     		mov	r1, r3
 479              		.loc 1 134 39
 480 009c 384B     		ldr	r3, .L38+4
 481 009e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 482              		.loc 1 134 49
 483 00a0 802B     		cmp	r3, #128
 484 00a2 0CBF     		ite	eq
 485 00a4 0123     		moveq	r3, #1
 486 00a6 0023     		movne	r3, #0
 487 00a8 DAB2     		uxtb	r2, r3
 488              		.loc 1 134 59
 489 00aa 354B     		ldr	r3, .L38+4
 490 00ac DB78     		ldrb	r3, [r3, #3]	@ zero_extendqisi2
 491 00ae 1846     		mov	r0, r3
 492              		.loc 1 134 73
 493 00b0 324B     		ldr	r3, .L38
 494 00b2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 495 00b4 053B     		subs	r3, r3, #5
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 12


 496              		.loc 1 134 49
 497 00b6 9842     		cmp	r0, r3
 498 00b8 0CBF     		ite	eq
 499 00ba 0123     		moveq	r3, #1
 500 00bc 0023     		movne	r3, #0
 501 00be DBB2     		uxtb	r3, r3
 502 00c0 1343     		orrs	r3, r3, r2
 503 00c2 DBB2     		uxtb	r3, r3
 504              		.loc 1 134 28
 505 00c4 0B40     		ands	r3, r3, r1
 506              		.loc 1 134 10
 507 00c6 002B     		cmp	r3, #0
 508 00c8 29D0     		beq	.L28
 135:User/Src/OBDII.c **** 		size[0]=obd_data[3];
 509              		.loc 1 135 19
 510 00ca 2D4B     		ldr	r3, .L38+4
 511 00cc DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 512              		.loc 1 135 10
 513 00ce 3B68     		ldr	r3, [r7]
 514 00d0 1A70     		strb	r2, [r3]
 136:User/Src/OBDII.c **** 		for(i=0;i<size[0];i++)
 515              		.loc 1 136 8
 516 00d2 0023     		movs	r3, #0
 517 00d4 FB60     		str	r3, [r7, #12]
 518              		.loc 1 136 3
 519 00d6 0AE0     		b	.L29
 520              	.L30:
 137:User/Src/OBDII.c **** 		rsp[i]=obd_data[i+4];
 521              		.loc 1 137 20 discriminator 3
 522 00d8 FB68     		ldr	r3, [r7, #12]
 523 00da 1A1D     		adds	r2, r3, #4
 524              		.loc 1 137 6 discriminator 3
 525 00dc FB68     		ldr	r3, [r7, #12]
 526 00de 7968     		ldr	r1, [r7, #4]
 527 00e0 0B44     		add	r3, r3, r1
 528              		.loc 1 137 18 discriminator 3
 529 00e2 2749     		ldr	r1, .L38+4
 530 00e4 8A5C     		ldrb	r2, [r1, r2]	@ zero_extendqisi2
 531              		.loc 1 137 9 discriminator 3
 532 00e6 1A70     		strb	r2, [r3]
 136:User/Src/OBDII.c **** 		for(i=0;i<size[0];i++)
 533              		.loc 1 136 22 discriminator 3
 534 00e8 FB68     		ldr	r3, [r7, #12]
 535 00ea 0133     		adds	r3, r3, #1
 536 00ec FB60     		str	r3, [r7, #12]
 537              	.L29:
 136:User/Src/OBDII.c **** 		for(i=0;i<size[0];i++)
 538              		.loc 1 136 17 discriminator 1
 539 00ee 3B68     		ldr	r3, [r7]
 540 00f0 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 541 00f2 1A46     		mov	r2, r3
 136:User/Src/OBDII.c **** 		for(i=0;i<size[0];i++)
 542              		.loc 1 136 3 discriminator 1
 543 00f4 FB68     		ldr	r3, [r7, #12]
 544 00f6 9342     		cmp	r3, r2
 545 00f8 EEDB     		blt	.L30
 138:User/Src/OBDII.c **** 			
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 13


 139:User/Src/OBDII.c **** 		for(i=0;i<obd_size_buf;i++)
 546              		.loc 1 139 8
 547 00fa 0023     		movs	r3, #0
 548 00fc FB60     		str	r3, [r7, #12]
 549              		.loc 1 139 3
 550 00fe 07E0     		b	.L31
 551              	.L32:
 140:User/Src/OBDII.c **** 		obd_data[i]=0;
 552              		.loc 1 140 14 discriminator 3
 553 0100 1F4A     		ldr	r2, .L38+4
 554 0102 FB68     		ldr	r3, [r7, #12]
 555 0104 1344     		add	r3, r3, r2
 556 0106 0022     		movs	r2, #0
 557 0108 1A70     		strb	r2, [r3]
 139:User/Src/OBDII.c **** 		obd_data[i]=0;
 558              		.loc 1 139 27 discriminator 3
 559 010a FB68     		ldr	r3, [r7, #12]
 560 010c 0133     		adds	r3, r3, #1
 561 010e FB60     		str	r3, [r7, #12]
 562              	.L31:
 139:User/Src/OBDII.c **** 		obd_data[i]=0;
 563              		.loc 1 139 3 discriminator 1
 564 0110 FB68     		ldr	r3, [r7, #12]
 565 0112 F92B     		cmp	r3, #249
 566 0114 F4DD     		ble	.L32
 141:User/Src/OBDII.c **** 		obd_count=0;		
 567              		.loc 1 141 12
 568 0116 194B     		ldr	r3, .L38
 569 0118 0022     		movs	r2, #0
 570 011a 1A70     		strb	r2, [r3]
 571 011c 22E0     		b	.L27
 572              	.L28:
 142:User/Src/OBDII.c **** 	}else if((dif_count_obd())&&(obd_count>0)&&((obd_data[0]&0x80)!=0x80)){
 573              		.loc 1 142 12
 574 011e FFF7FEFF 		bl	dif_count_obd
 575 0122 0346     		mov	r3, r0
 576              		.loc 1 142 10
 577 0124 002B     		cmp	r3, #0
 578 0126 1AD0     		beq	.L33
 579              		.loc 1 142 40 discriminator 1
 580 0128 144B     		ldr	r3, .L38
 581 012a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 582              		.loc 1 142 28 discriminator 1
 583 012c 002B     		cmp	r3, #0
 584 012e 16D0     		beq	.L33
 585              		.loc 1 142 55 discriminator 2
 586 0130 134B     		ldr	r3, .L38+4
 587 0132 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 588              		.loc 1 142 64 discriminator 2
 589 0134 5BB2     		sxtb	r3, r3
 590              		.loc 1 142 43 discriminator 2
 591 0136 002B     		cmp	r3, #0
 592 0138 11DB     		blt	.L33
 143:User/Src/OBDII.c **** 		for(i=0; i<15; i++)
 593              		.loc 1 143 8
 594 013a 0023     		movs	r3, #0
 595 013c FB60     		str	r3, [r7, #12]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 14


 596              		.loc 1 143 3
 597 013e 07E0     		b	.L34
 598              	.L35:
 144:User/Src/OBDII.c ****             obd_data[i]=0;
 599              		.loc 1 144 24 discriminator 3
 600 0140 0F4A     		ldr	r2, .L38+4
 601 0142 FB68     		ldr	r3, [r7, #12]
 602 0144 1344     		add	r3, r3, r2
 603 0146 0022     		movs	r2, #0
 604 0148 1A70     		strb	r2, [r3]
 143:User/Src/OBDII.c **** 		for(i=0; i<15; i++)
 605              		.loc 1 143 19 discriminator 3
 606 014a FB68     		ldr	r3, [r7, #12]
 607 014c 0133     		adds	r3, r3, #1
 608 014e FB60     		str	r3, [r7, #12]
 609              	.L34:
 143:User/Src/OBDII.c **** 		for(i=0; i<15; i++)
 610              		.loc 1 143 3 discriminator 1
 611 0150 FB68     		ldr	r3, [r7, #12]
 612 0152 0E2B     		cmp	r3, #14
 613 0154 F4DD     		ble	.L35
 145:User/Src/OBDII.c ****             obd_count=0;				
 614              		.loc 1 145 22
 615 0156 094B     		ldr	r3, .L38
 616 0158 0022     		movs	r2, #0
 617 015a 1A70     		strb	r2, [r3]
 618 015c 02E0     		b	.L27
 619              	.L33:
 146:User/Src/OBDII.c **** 	}else{
 147:User/Src/OBDII.c **** 	    size[0]=0;
 620              		.loc 1 147 13
 621 015e 3B68     		ldr	r3, [r7]
 622 0160 0022     		movs	r2, #0
 623 0162 1A70     		strb	r2, [r3]
 624              	.L27:
 148:User/Src/OBDII.c **** 	}
 149:User/Src/OBDII.c **** 
 150:User/Src/OBDII.c ****     if(obd_count>20)
 625              		.loc 1 150 17
 626 0164 054B     		ldr	r3, .L38
 627 0166 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 628              		.loc 1 150 7
 629 0168 142B     		cmp	r3, #20
 630 016a 02D9     		bls	.L37
 151:User/Src/OBDII.c ****         size[0]=0;
 631              		.loc 1 151 16
 632 016c 3B68     		ldr	r3, [r7]
 633 016e 0022     		movs	r2, #0
 634 0170 1A70     		strb	r2, [r3]
 635              	.L37:
 152:User/Src/OBDII.c **** }
 636              		.loc 1 152 1
 637 0172 00BF     		nop
 638 0174 1037     		adds	r7, r7, #16
 639              	.LCFI13:
 640              		.cfi_def_cfa_offset 8
 641 0176 BD46     		mov	sp, r7
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 15


 642              	.LCFI14:
 643              		.cfi_def_cfa_register 13
 644              		@ sp needed
 645 0178 80BD     		pop	{r7, pc}
 646              	.L39:
 647 017a 00BF     		.align	2
 648              	.L38:
 649 017c 00000000 		.word	obd_count
 650 0180 00000000 		.word	obd_data
 651              		.cfi_endproc
 652              	.LFE137:
 654              		.section	.text.K_line_send,"ax",%progbits
 655              		.align	1
 656              		.global	K_line_send
 657              		.syntax unified
 658              		.thumb
 659              		.thumb_func
 661              	K_line_send:
 662              	.LFB138:
 153:User/Src/OBDII.c **** 
 154:User/Src/OBDII.c **** 
 155:User/Src/OBDII.c **** /*******************************************************************************
 156:User/Src/OBDII.c **** * Function Name  : K_line_send
 157:User/Src/OBDII.c **** * Description    : send data through serial protocol (ISO 9141-2)
 158:User/Src/OBDII.c **** * Input          : rsp (response address to store) ,size(size of recive to store)
 159:User/Src/OBDII.c **** * Output         : None
 160:User/Src/OBDII.c **** * Return         : None
 161:User/Src/OBDII.c **** *******************************************************************************/		
 162:User/Src/OBDII.c **** void K_line_send(uint8_t *rsp,uint8_t size)
 163:User/Src/OBDII.c **** {
 663              		.loc 1 163 1
 664              		.cfi_startproc
 665              		@ args = 0, pretend = 0, frame = 16
 666              		@ frame_needed = 1, uses_anonymous_args = 0
 667 0000 80B5     		push	{r7, lr}
 668              	.LCFI15:
 669              		.cfi_def_cfa_offset 8
 670              		.cfi_offset 7, -8
 671              		.cfi_offset 14, -4
 672 0002 84B0     		sub	sp, sp, #16
 673              	.LCFI16:
 674              		.cfi_def_cfa_offset 24
 675 0004 00AF     		add	r7, sp, #0
 676              	.LCFI17:
 677              		.cfi_def_cfa_register 7
 678 0006 7860     		str	r0, [r7, #4]
 679 0008 0B46     		mov	r3, r1
 680 000a FB70     		strb	r3, [r7, #3]
 164:User/Src/OBDII.c **** 	int i=0;
 681              		.loc 1 164 6
 682 000c 0023     		movs	r3, #0
 683 000e FB60     		str	r3, [r7, #12]
 165:User/Src/OBDII.c **** 	uint8_t crc=0;
 684              		.loc 1 165 10
 685 0010 0023     		movs	r3, #0
 686 0012 FB72     		strb	r3, [r7, #11]
 166:User/Src/OBDII.c **** 	OBD_RCV_T=0;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 16


 687              		.loc 1 166 11
 688 0014 494B     		ldr	r3, .L53
 689 0016 0022     		movs	r2, #0
 690 0018 1A70     		strb	r2, [r3]
 167:User/Src/OBDII.c **** 	
 168:User/Src/OBDII.c **** 	while(!dif_count_obd());
 691              		.loc 1 168 7
 692 001a 00BF     		nop
 693              	.L41:
 694              		.loc 1 168 9 discriminator 1
 695 001c FFF7FEFF 		bl	dif_count_obd
 696 0020 0346     		mov	r3, r0
 697              		.loc 1 168 7 discriminator 1
 698 0022 002B     		cmp	r3, #0
 699 0024 FAD0     		beq	.L41
 169:User/Src/OBDII.c **** 	while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 700              		.loc 1 169 8
 701 0026 00BF     		nop
 702              	.L42:
 703              		.loc 1 169 9 discriminator 1
 704 0028 4021     		movs	r1, #64
 705 002a 4548     		ldr	r0, .L53+4
 706 002c FFF7FEFF 		bl	USART_GetFlagStatus
 707 0030 0346     		mov	r3, r0
 708              		.loc 1 169 8 discriminator 1
 709 0032 002B     		cmp	r3, #0
 710 0034 F8D0     		beq	.L42
 170:User/Src/OBDII.c ****     USART_SendData(USART1,0xc0+size);			
 711              		.loc 1 170 5
 712 0036 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 713 0038 9BB2     		uxth	r3, r3
 714 003a C033     		adds	r3, r3, #192
 715 003c 9BB2     		uxth	r3, r3
 716 003e 1946     		mov	r1, r3
 717 0040 3F48     		ldr	r0, .L53+4
 718 0042 FFF7FEFF 		bl	USART_SendData
 171:User/Src/OBDII.c **** 	crc=0xc0+size;
 719              		.loc 1 171 5
 720 0046 FB78     		ldrb	r3, [r7, #3]
 721 0048 403B     		subs	r3, r3, #64
 722 004a FB72     		strb	r3, [r7, #11]
 172:User/Src/OBDII.c **** 	while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 723              		.loc 1 172 8
 724 004c 00BF     		nop
 725              	.L43:
 726              		.loc 1 172 9 discriminator 1
 727 004e 4021     		movs	r1, #64
 728 0050 3B48     		ldr	r0, .L53+4
 729 0052 FFF7FEFF 		bl	USART_GetFlagStatus
 730 0056 0346     		mov	r3, r0
 731              		.loc 1 172 8 discriminator 1
 732 0058 002B     		cmp	r3, #0
 733 005a F8D0     		beq	.L43
 173:User/Src/OBDII.c ****     USART_SendData(USART1,0x33);		
 734              		.loc 1 173 5
 735 005c 3321     		movs	r1, #51
 736 005e 3848     		ldr	r0, .L53+4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 17


 737 0060 FFF7FEFF 		bl	USART_SendData
 174:User/Src/OBDII.c **** 	crc=crc+0x33;
 738              		.loc 1 174 5
 739 0064 FB7A     		ldrb	r3, [r7, #11]
 740 0066 3333     		adds	r3, r3, #51
 741 0068 FB72     		strb	r3, [r7, #11]
 175:User/Src/OBDII.c **** 	while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 742              		.loc 1 175 8
 743 006a 00BF     		nop
 744              	.L44:
 745              		.loc 1 175 9 discriminator 1
 746 006c 4021     		movs	r1, #64
 747 006e 3448     		ldr	r0, .L53+4
 748 0070 FFF7FEFF 		bl	USART_GetFlagStatus
 749 0074 0346     		mov	r3, r0
 750              		.loc 1 175 8 discriminator 1
 751 0076 002B     		cmp	r3, #0
 752 0078 F8D0     		beq	.L44
 176:User/Src/OBDII.c ****     USART_SendData(USART1,0xf1);	
 753              		.loc 1 176 5
 754 007a F121     		movs	r1, #241
 755 007c 3048     		ldr	r0, .L53+4
 756 007e FFF7FEFF 		bl	USART_SendData
 177:User/Src/OBDII.c **** 	crc=crc+0xf1;
 757              		.loc 1 177 5
 758 0082 FB7A     		ldrb	r3, [r7, #11]
 759 0084 0F3B     		subs	r3, r3, #15
 760 0086 FB72     		strb	r3, [r7, #11]
 178:User/Src/OBDII.c **** 
 179:User/Src/OBDII.c **** 	for(i=0;i<size;i++)
 761              		.loc 1 179 7
 762 0088 0023     		movs	r3, #0
 763 008a FB60     		str	r3, [r7, #12]
 764              		.loc 1 179 2
 765 008c 1AE0     		b	.L45
 766              	.L47:
 180:User/Src/OBDII.c **** 	{
 181:User/Src/OBDII.c **** 		while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 767              		.loc 1 181 9
 768 008e 00BF     		nop
 769              	.L46:
 770              		.loc 1 181 10 discriminator 1
 771 0090 4021     		movs	r1, #64
 772 0092 2B48     		ldr	r0, .L53+4
 773 0094 FFF7FEFF 		bl	USART_GetFlagStatus
 774 0098 0346     		mov	r3, r0
 775              		.loc 1 181 9 discriminator 1
 776 009a 002B     		cmp	r3, #0
 777 009c F8D0     		beq	.L46
 182:User/Src/OBDII.c **** 		USART_SendData(USART1,rsp[i]);
 778              		.loc 1 182 28 discriminator 2
 779 009e FB68     		ldr	r3, [r7, #12]
 780 00a0 7A68     		ldr	r2, [r7, #4]
 781 00a2 1344     		add	r3, r3, r2
 782 00a4 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 783              		.loc 1 182 3 discriminator 2
 784 00a6 9BB2     		uxth	r3, r3
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 18


 785 00a8 1946     		mov	r1, r3
 786 00aa 2548     		ldr	r0, .L53+4
 787 00ac FFF7FEFF 		bl	USART_SendData
 183:User/Src/OBDII.c **** 		crc=crc+rsp[i];
 788              		.loc 1 183 14 discriminator 2
 789 00b0 FB68     		ldr	r3, [r7, #12]
 790 00b2 7A68     		ldr	r2, [r7, #4]
 791 00b4 1344     		add	r3, r3, r2
 792 00b6 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 793              		.loc 1 183 6 discriminator 2
 794 00b8 FB7A     		ldrb	r3, [r7, #11]
 795 00ba 1344     		add	r3, r3, r2
 796 00bc FB72     		strb	r3, [r7, #11]
 179:User/Src/OBDII.c **** 	{
 797              		.loc 1 179 18 discriminator 2
 798 00be FB68     		ldr	r3, [r7, #12]
 799 00c0 0133     		adds	r3, r3, #1
 800 00c2 FB60     		str	r3, [r7, #12]
 801              	.L45:
 179:User/Src/OBDII.c **** 	{
 802              		.loc 1 179 11 discriminator 1
 803 00c4 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 179:User/Src/OBDII.c **** 	{
 804              		.loc 1 179 2 discriminator 1
 805 00c6 FA68     		ldr	r2, [r7, #12]
 806 00c8 9A42     		cmp	r2, r3
 807 00ca E0DB     		blt	.L47
 184:User/Src/OBDII.c **** 
 185:User/Src/OBDII.c **** 	}
 186:User/Src/OBDII.c **** 	
 187:User/Src/OBDII.c ****     while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 808              		.loc 1 187 11
 809 00cc 00BF     		nop
 810              	.L48:
 811              		.loc 1 187 12 discriminator 1
 812 00ce 4021     		movs	r1, #64
 813 00d0 1B48     		ldr	r0, .L53+4
 814 00d2 FFF7FEFF 		bl	USART_GetFlagStatus
 815 00d6 0346     		mov	r3, r0
 816              		.loc 1 187 11 discriminator 1
 817 00d8 002B     		cmp	r3, #0
 818 00da F8D0     		beq	.L48
 188:User/Src/OBDII.c ****     USART_SendData(USART1,crc);	
 819              		.loc 1 188 5
 820 00dc FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 821 00de 9BB2     		uxth	r3, r3
 822 00e0 1946     		mov	r1, r3
 823 00e2 1748     		ldr	r0, .L53+4
 824 00e4 FFF7FEFF 		bl	USART_SendData
 189:User/Src/OBDII.c **** 	while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 825              		.loc 1 189 8
 826 00e8 00BF     		nop
 827              	.L49:
 828              		.loc 1 189 9 discriminator 1
 829 00ea 4021     		movs	r1, #64
 830 00ec 1448     		ldr	r0, .L53+4
 831 00ee FFF7FEFF 		bl	USART_GetFlagStatus
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 19


 832 00f2 0346     		mov	r3, r0
 833              		.loc 1 189 8 discriminator 1
 834 00f4 002B     		cmp	r3, #0
 835 00f6 F8D0     		beq	.L49
 190:User/Src/OBDII.c **** 	for(i=0;i<obd_size_buf;i++)
 836              		.loc 1 190 7
 837 00f8 0023     		movs	r3, #0
 838 00fa FB60     		str	r3, [r7, #12]
 839              		.loc 1 190 2
 840 00fc 07E0     		b	.L50
 841              	.L51:
 191:User/Src/OBDII.c **** 	    obd_data[i]=0;
 842              		.loc 1 191 17 discriminator 3
 843 00fe 114A     		ldr	r2, .L53+8
 844 0100 FB68     		ldr	r3, [r7, #12]
 845 0102 1344     		add	r3, r3, r2
 846 0104 0022     		movs	r2, #0
 847 0106 1A70     		strb	r2, [r3]
 190:User/Src/OBDII.c **** 	for(i=0;i<obd_size_buf;i++)
 848              		.loc 1 190 26 discriminator 3
 849 0108 FB68     		ldr	r3, [r7, #12]
 850 010a 0133     		adds	r3, r3, #1
 851 010c FB60     		str	r3, [r7, #12]
 852              	.L50:
 190:User/Src/OBDII.c **** 	for(i=0;i<obd_size_buf;i++)
 853              		.loc 1 190 2 discriminator 1
 854 010e FB68     		ldr	r3, [r7, #12]
 855 0110 F92B     		cmp	r3, #249
 856 0112 F4DD     		ble	.L51
 192:User/Src/OBDII.c **** 	
 193:User/Src/OBDII.c **** 	while(!dif_count_obd());
 857              		.loc 1 193 7
 858 0114 00BF     		nop
 859              	.L52:
 860              		.loc 1 193 9 discriminator 1
 861 0116 FFF7FEFF 		bl	dif_count_obd
 862 011a 0346     		mov	r3, r0
 863              		.loc 1 193 7 discriminator 1
 864 011c 002B     		cmp	r3, #0
 865 011e FAD0     		beq	.L52
 194:User/Src/OBDII.c **** 	OBD_RCV_T=1;
 866              		.loc 1 194 11
 867 0120 064B     		ldr	r3, .L53
 868 0122 0122     		movs	r2, #1
 869 0124 1A70     		strb	r2, [r3]
 195:User/Src/OBDII.c **** 	setms_timecount_obd2(4000);
 870              		.loc 1 195 2
 871 0126 4FF47A60 		mov	r0, #4000
 872 012a FFF7FEFF 		bl	setms_timecount_obd2
 196:User/Src/OBDII.c **** 	obd_count=0;
 873              		.loc 1 196 11
 874 012e 064B     		ldr	r3, .L53+12
 875 0130 0022     		movs	r2, #0
 876 0132 1A70     		strb	r2, [r3]
 197:User/Src/OBDII.c **** }
 877              		.loc 1 197 1
 878 0134 00BF     		nop
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 20


 879 0136 1037     		adds	r7, r7, #16
 880              	.LCFI18:
 881              		.cfi_def_cfa_offset 8
 882 0138 BD46     		mov	sp, r7
 883              	.LCFI19:
 884              		.cfi_def_cfa_register 13
 885              		@ sp needed
 886 013a 80BD     		pop	{r7, pc}
 887              	.L54:
 888              		.align	2
 889              	.L53:
 890 013c 00000000 		.word	OBD_RCV_T
 891 0140 00100140 		.word	1073811456
 892 0144 00000000 		.word	obd_data
 893 0148 00000000 		.word	obd_count
 894              		.cfi_endproc
 895              	.LFE138:
 897              		.section	.text.K_line_slow_init,"ax",%progbits
 898              		.align	1
 899              		.global	K_line_slow_init
 900              		.syntax unified
 901              		.thumb
 902              		.thumb_func
 904              	K_line_slow_init:
 905              	.LFB139:
 198:User/Src/OBDII.c **** 
 199:User/Src/OBDII.c **** 
 200:User/Src/OBDII.c **** /*******************************************************************************
 201:User/Src/OBDII.c **** * Function Name  : K_line_slow_init
 202:User/Src/OBDII.c **** * Description    : slow init method serial protocol (ISO 9141-2)
 203:User/Src/OBDII.c **** * Input          : None
 204:User/Src/OBDII.c **** * Output         : None
 205:User/Src/OBDII.c **** * Return         : None
 206:User/Src/OBDII.c **** *******************************************************************************/		
 207:User/Src/OBDII.c **** void K_line_slow_init(void)
 208:User/Src/OBDII.c **** { 
 906              		.loc 1 208 1
 907              		.cfi_startproc
 908              		@ args = 0, pretend = 0, frame = 32
 909              		@ frame_needed = 1, uses_anonymous_args = 0
 910 0000 80B5     		push	{r7, lr}
 911              	.LCFI20:
 912              		.cfi_def_cfa_offset 8
 913              		.cfi_offset 7, -8
 914              		.cfi_offset 14, -4
 915 0002 88B0     		sub	sp, sp, #32
 916              	.LCFI21:
 917              		.cfi_def_cfa_offset 40
 918 0004 00AF     		add	r7, sp, #0
 919              	.LCFI22:
 920              		.cfi_def_cfa_register 7
 209:User/Src/OBDII.c **** 	GPIO_InitTypeDef GPIO_InitStructure;	
 210:User/Src/OBDII.c ****     uint16_t temp=0;
 921              		.loc 1 210 14
 922 0006 0023     		movs	r3, #0
 923 0008 FB83     		strh	r3, [r7, #30]	@ movhi
 211:User/Src/OBDII.c **** 	TIM_TimeBaseInitTypeDef TIM_TimeBaseStructure;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 21


 212:User/Src/OBDII.c **** 	NVIC_InitTypeDef NVIC_InitStructure; 
 213:User/Src/OBDII.c **** 
 214:User/Src/OBDII.c **** 	RCC_APB2PeriphClockCmd(RCC_AHB1Periph_GPIOA, ENABLE);
 924              		.loc 1 214 2
 925 000a 0121     		movs	r1, #1
 926 000c 0120     		movs	r0, #1
 927 000e FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 215:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOA, GPIO_Pin_9);
 928              		.loc 1 215 2
 929 0012 4FF40071 		mov	r1, #512
 930 0016 8B48     		ldr	r0, .L70
 931 0018 FFF7FEFF 		bl	GPIO_SetBits
 216:User/Src/OBDII.c **** 	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;	         
 932              		.loc 1 216 30
 933 001c 4FF40073 		mov	r3, #512
 934 0020 7B61     		str	r3, [r7, #20]
 217:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
 935              		.loc 1 217 34
 936 0022 0123     		movs	r3, #1
 937 0024 3B76     		strb	r3, [r7, #24]
 218:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 938              		.loc 1 218 35
 939 0026 0023     		movs	r3, #0
 940 0028 BB76     		strb	r3, [r7, #26]
 219:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 941              		.loc 1 219 34
 942 002a 0023     		movs	r3, #0
 943 002c FB76     		strb	r3, [r7, #27]
 220:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 944              		.loc 1 220 35
 945 002e 0223     		movs	r3, #2
 946 0030 7B76     		strb	r3, [r7, #25]
 221:User/Src/OBDII.c **** 
 222:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);		   
 947              		.loc 1 222 5
 948 0032 07F11403 		add	r3, r7, #20
 949 0036 1946     		mov	r1, r3
 950 0038 8248     		ldr	r0, .L70
 951 003a FFF7FEFF 		bl	GPIO_Init
 223:User/Src/OBDII.c ****  
 224:User/Src/OBDII.c **** 		
 225:User/Src/OBDII.c **** 	RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2 , ENABLE);
 952              		.loc 1 225 2
 953 003e 0121     		movs	r1, #1
 954 0040 0120     		movs	r0, #1
 955 0042 FFF7FEFF 		bl	RCC_APB1PeriphClockCmd
 226:User/Src/OBDII.c ****     TIM_DeInit(TIM2);
 956              		.loc 1 226 5
 957 0046 4FF08040 		mov	r0, #1073741824
 958 004a FFF7FEFF 		bl	TIM_DeInit
 227:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_Period=1000;
 959              		.loc 1 227 37
 960 004e 4FF47A73 		mov	r3, #1000
 961 0052 FB60     		str	r3, [r7, #12]
 228:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_Prescaler= (36 - 1);		
 962              		.loc 1 228 40
 963 0054 2323     		movs	r3, #35
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 22


 964 0056 3B81     		strh	r3, [r7, #8]	@ movhi
 229:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_ClockDivision=TIM_CKD_DIV1; 		
 965              		.loc 1 229 44
 966 0058 0023     		movs	r3, #0
 967 005a 3B82     		strh	r3, [r7, #16]	@ movhi
 230:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_CounterMode=TIM_CounterMode_Up; 	
 968              		.loc 1 230 42
 969 005c 0023     		movs	r3, #0
 970 005e 7B81     		strh	r3, [r7, #10]	@ movhi
 231:User/Src/OBDII.c ****     TIM_TimeBaseInit(TIM2, &TIM_TimeBaseStructure);
 971              		.loc 1 231 5
 972 0060 07F10803 		add	r3, r7, #8
 973 0064 1946     		mov	r1, r3
 974 0066 4FF08040 		mov	r0, #1073741824
 975 006a FFF7FEFF 		bl	TIM_TimeBaseInit
 232:User/Src/OBDII.c ****     TIM_ClearFlag(TIM2, TIM_FLAG_Update);							 
 976              		.loc 1 232 5
 977 006e 0121     		movs	r1, #1
 978 0070 4FF08040 		mov	r0, #1073741824
 979 0074 FFF7FEFF 		bl	TIM_ClearFlag
 233:User/Src/OBDII.c ****     TIM_ITConfig(TIM2,TIM_IT_Update,ENABLE);
 980              		.loc 1 233 5
 981 0078 0122     		movs	r2, #1
 982 007a 0121     		movs	r1, #1
 983 007c 4FF08040 		mov	r0, #1073741824
 984 0080 FFF7FEFF 		bl	TIM_ITConfig
 234:User/Src/OBDII.c ****     TIM_Cmd(TIM2, ENABLE);
 985              		.loc 1 234 5
 986 0084 0121     		movs	r1, #1
 987 0086 4FF08040 		mov	r0, #1073741824
 988 008a FFF7FEFF 		bl	TIM_Cmd
 235:User/Src/OBDII.c **** 
 236:User/Src/OBDII.c ****     NVIC_PriorityGroupConfig(NVIC_PriorityGroup_0);  													
 989              		.loc 1 236 5
 990 008e 4FF4E060 		mov	r0, #1792
 991 0092 FFF7FEFF 		bl	NVIC_PriorityGroupConfig
 237:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;	  
 992              		.loc 1 237 40
 993 0096 1C23     		movs	r3, #28
 994 0098 3B71     		strb	r3, [r7, #4]
 238:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 995              		.loc 1 238 58
 996 009a 0023     		movs	r3, #0
 997 009c 7B71     		strb	r3, [r7, #5]
 239:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;	
 998              		.loc 1 239 51
 999 009e 0023     		movs	r3, #0
 1000 00a0 BB71     		strb	r3, [r7, #6]
 240:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 1001              		.loc 1 240 43
 1002 00a2 0123     		movs	r3, #1
 1003 00a4 FB71     		strb	r3, [r7, #7]
 241:User/Src/OBDII.c ****     NVIC_Init(&NVIC_InitStructure);	
 1004              		.loc 1 241 5
 1005 00a6 3B1D     		adds	r3, r7, #4
 1006 00a8 1846     		mov	r0, r3
 1007 00aa FFF7FEFF 		bl	NVIC_Init
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 23


 242:User/Src/OBDII.c **** 		
 243:User/Src/OBDII.c **** 	while(init_obd!=600);
 1008              		.loc 1 243 7
 1009 00ae 00BF     		nop
 1010              	.L56:
 1011              		.loc 1 243 16 discriminator 1
 1012 00b0 654B     		ldr	r3, .L70+4
 1013 00b2 1B88     		ldrh	r3, [r3]
 1014              		.loc 1 243 7 discriminator 1
 1015 00b4 B3F5167F 		cmp	r3, #600
 1016 00b8 FAD1     		bne	.L56
 244:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOA,GPIO_Pin_9);
 1017              		.loc 1 244 2
 1018 00ba 4FF40071 		mov	r1, #512
 1019 00be 6148     		ldr	r0, .L70
 1020 00c0 FFF7FEFF 		bl	GPIO_ResetBits
 245:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOC,GPIO_Pin_13);
 1021              		.loc 1 245 2
 1022 00c4 4FF40051 		mov	r1, #8192
 1023 00c8 6048     		ldr	r0, .L70+8
 1024 00ca FFF7FEFF 		bl	GPIO_SetBits
 246:User/Src/OBDII.c **** 	
 247:User/Src/OBDII.c **** 	while(init_obd!=1000);
 1025              		.loc 1 247 7
 1026 00ce 00BF     		nop
 1027              	.L57:
 1028              		.loc 1 247 16 discriminator 1
 1029 00d0 5D4B     		ldr	r3, .L70+4
 1030 00d2 1B88     		ldrh	r3, [r3]
 1031              		.loc 1 247 7 discriminator 1
 1032 00d4 B3F57A7F 		cmp	r3, #1000
 1033 00d8 FAD1     		bne	.L57
 248:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOA,GPIO_Pin_9);
 1034              		.loc 1 248 2
 1035 00da 4FF40071 		mov	r1, #512
 1036 00de 5948     		ldr	r0, .L70
 1037 00e0 FFF7FEFF 		bl	GPIO_SetBits
 249:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOC,GPIO_Pin_13);
 1038              		.loc 1 249 2
 1039 00e4 4FF40051 		mov	r1, #8192
 1040 00e8 5848     		ldr	r0, .L70+8
 1041 00ea FFF7FEFF 		bl	GPIO_ResetBits
 250:User/Src/OBDII.c **** 	
 251:User/Src/OBDII.c **** 	while(init_obd!=1800);
 1042              		.loc 1 251 7
 1043 00ee 00BF     		nop
 1044              	.L58:
 1045              		.loc 1 251 16 discriminator 1
 1046 00f0 554B     		ldr	r3, .L70+4
 1047 00f2 1B88     		ldrh	r3, [r3]
 1048              		.loc 1 251 7 discriminator 1
 1049 00f4 B3F5E16F 		cmp	r3, #1800
 1050 00f8 FAD1     		bne	.L58
 252:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOA,GPIO_Pin_9);
 1051              		.loc 1 252 2
 1052 00fa 4FF40071 		mov	r1, #512
 1053 00fe 5148     		ldr	r0, .L70
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 24


 1054 0100 FFF7FEFF 		bl	GPIO_ResetBits
 253:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOC,GPIO_Pin_13);
 1055              		.loc 1 253 2
 1056 0104 4FF40051 		mov	r1, #8192
 1057 0108 5048     		ldr	r0, .L70+8
 1058 010a FFF7FEFF 		bl	GPIO_SetBits
 254:User/Src/OBDII.c **** 	
 255:User/Src/OBDII.c **** 	while(init_obd!=2600);
 1059              		.loc 1 255 7
 1060 010e 00BF     		nop
 1061              	.L59:
 1062              		.loc 1 255 16 discriminator 1
 1063 0110 4D4B     		ldr	r3, .L70+4
 1064 0112 1B88     		ldrh	r3, [r3]
 1065              		.loc 1 255 7 discriminator 1
 1066 0114 40F62822 		movw	r2, #2600
 1067 0118 9342     		cmp	r3, r2
 1068 011a F9D1     		bne	.L59
 256:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOA,GPIO_Pin_9);
 1069              		.loc 1 256 2
 1070 011c 4FF40071 		mov	r1, #512
 1071 0120 4848     		ldr	r0, .L70
 1072 0122 FFF7FEFF 		bl	GPIO_SetBits
 257:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOC,GPIO_Pin_13);
 1073              		.loc 1 257 2
 1074 0126 4FF40051 		mov	r1, #8192
 1075 012a 4848     		ldr	r0, .L70+8
 1076 012c FFF7FEFF 		bl	GPIO_ResetBits
 258:User/Src/OBDII.c **** 	
 259:User/Src/OBDII.c **** 	while(init_obd!=3400);
 1077              		.loc 1 259 7
 1078 0130 00BF     		nop
 1079              	.L60:
 1080              		.loc 1 259 16 discriminator 1
 1081 0132 454B     		ldr	r3, .L70+4
 1082 0134 1B88     		ldrh	r3, [r3]
 1083              		.loc 1 259 7 discriminator 1
 1084 0136 40F64852 		movw	r2, #3400
 1085 013a 9342     		cmp	r3, r2
 1086 013c F9D1     		bne	.L60
 260:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOA,GPIO_Pin_9);
 1087              		.loc 1 260 2
 1088 013e 4FF40071 		mov	r1, #512
 1089 0142 4048     		ldr	r0, .L70
 1090 0144 FFF7FEFF 		bl	GPIO_ResetBits
 261:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOC,GPIO_Pin_13);
 1091              		.loc 1 261 2
 1092 0148 4FF40051 		mov	r1, #8192
 1093 014c 3F48     		ldr	r0, .L70+8
 1094 014e FFF7FEFF 		bl	GPIO_SetBits
 262:User/Src/OBDII.c **** 	
 263:User/Src/OBDII.c **** 	while(init_obd!=4200);
 1095              		.loc 1 263 7
 1096 0152 00BF     		nop
 1097              	.L61:
 1098              		.loc 1 263 16 discriminator 1
 1099 0154 3C4B     		ldr	r3, .L70+4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 25


 1100 0156 1B88     		ldrh	r3, [r3]
 1101              		.loc 1 263 7 discriminator 1
 1102 0158 41F26802 		movw	r2, #4200
 1103 015c 9342     		cmp	r3, r2
 1104 015e F9D1     		bne	.L61
 264:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOA,GPIO_Pin_9);
 1105              		.loc 1 264 2
 1106 0160 4FF40071 		mov	r1, #512
 1107 0164 3748     		ldr	r0, .L70
 1108 0166 FFF7FEFF 		bl	GPIO_SetBits
 265:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOC,GPIO_Pin_13);
 1109              		.loc 1 265 2
 1110 016a 4FF40051 		mov	r1, #8192
 1111 016e 3748     		ldr	r0, .L70+8
 1112 0170 FFF7FEFF 		bl	GPIO_ResetBits
 266:User/Src/OBDII.c **** 	obd_count=0;
 1113              		.loc 1 266 11
 1114 0174 364B     		ldr	r3, .L70+12
 1115 0176 0022     		movs	r2, #0
 1116 0178 1A70     		strb	r2, [r3]
 267:User/Src/OBDII.c ****     //while(init_obd!=4700);	
 268:User/Src/OBDII.c **** 	
 269:User/Src/OBDII.c **** 	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;	         
 1117              		.loc 1 269 30
 1118 017a 4FF40073 		mov	r3, #512
 1119 017e 7B61     		str	r3, [r7, #20]
 270:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF; 
 1120              		.loc 1 270 34
 1121 0180 0223     		movs	r3, #2
 1122 0182 3B76     		strb	r3, [r7, #24]
 271:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz; 
 1123              		.loc 1 271 35
 1124 0184 0223     		movs	r3, #2
 1125 0186 7B76     		strb	r3, [r7, #25]
 272:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);		 
 1126              		.loc 1 272 5
 1127 0188 07F11403 		add	r3, r7, #20
 1128 018c 1946     		mov	r1, r3
 1129 018e 2D48     		ldr	r0, .L70
 1130 0190 FFF7FEFF 		bl	GPIO_Init
 273:User/Src/OBDII.c **** 	
 274:User/Src/OBDII.c **** 	OBD_RCV_T=1;
 1131              		.loc 1 274 11
 1132 0194 2F4B     		ldr	r3, .L70+16
 1133 0196 0122     		movs	r2, #1
 1134 0198 1A70     		strb	r2, [r3]
 275:User/Src/OBDII.c **** 
 276:User/Src/OBDII.c ****     while((obd_count<2)&&(init_obd<4880));
 1135              		.loc 1 276 10
 1136 019a 00BF     		nop
 1137              	.L63:
 1138              		.loc 1 276 21 discriminator 2
 1139 019c 2C4B     		ldr	r3, .L70+12
 1140 019e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1141              		.loc 1 276 10 discriminator 2
 1142 01a0 012B     		cmp	r3, #1
 1143 01a2 05D8     		bhi	.L62
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 26


 1144              		.loc 1 276 35 discriminator 1
 1145 01a4 284B     		ldr	r3, .L70+4
 1146 01a6 1B88     		ldrh	r3, [r3]
 1147              		.loc 1 276 24 discriminator 1
 1148 01a8 41F20F32 		movw	r2, #4879
 1149 01ac 9342     		cmp	r3, r2
 1150 01ae F5D9     		bls	.L63
 1151              	.L62:
 277:User/Src/OBDII.c **** 
 278:User/Src/OBDII.c ****     if(obd_count==2)
 1152              		.loc 1 278 17
 1153 01b0 274B     		ldr	r3, .L70+12
 1154 01b2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1155              		.loc 1 278 7
 1156 01b4 022B     		cmp	r3, #2
 1157 01b6 39D1     		bne	.L64
 279:User/Src/OBDII.c **** 	{
 280:User/Src/OBDII.c **** 		temp=init_obd;
 1158              		.loc 1 280 7
 1159 01b8 234B     		ldr	r3, .L70+4
 1160 01ba 1B88     		ldrh	r3, [r3]	@ movhi
 1161 01bc FB83     		strh	r3, [r7, #30]	@ movhi
 281:User/Src/OBDII.c **** 		OBD_RCV_T=0;	
 1162              		.loc 1 281 12
 1163 01be 254B     		ldr	r3, .L70+16
 1164 01c0 0022     		movs	r2, #0
 1165 01c2 1A70     		strb	r2, [r3]
 282:User/Src/OBDII.c ****         while(init_obd!=(temp+80));
 1166              		.loc 1 282 14
 1167 01c4 00BF     		nop
 1168              	.L65:
 1169              		.loc 1 282 23 discriminator 1
 1170 01c6 204B     		ldr	r3, .L70+4
 1171 01c8 1B88     		ldrh	r3, [r3]
 1172 01ca 1A46     		mov	r2, r3
 1173              		.loc 1 282 30 discriminator 1
 1174 01cc FB8B     		ldrh	r3, [r7, #30]
 1175 01ce 5033     		adds	r3, r3, #80
 1176              		.loc 1 282 14 discriminator 1
 1177 01d0 9A42     		cmp	r2, r3
 1178 01d2 F8D1     		bne	.L65
 283:User/Src/OBDII.c ****         while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 1179              		.loc 1 283 15
 1180 01d4 00BF     		nop
 1181              	.L66:
 1182              		.loc 1 283 16 discriminator 1
 1183 01d6 4021     		movs	r1, #64
 1184 01d8 1F48     		ldr	r0, .L70+20
 1185 01da FFF7FEFF 		bl	USART_GetFlagStatus
 1186 01de 0346     		mov	r3, r0
 1187              		.loc 1 283 15 discriminator 1
 1188 01e0 002B     		cmp	r3, #0
 1189 01e2 F8D0     		beq	.L66
 284:User/Src/OBDII.c ****         USART_SendData(USART1,0x70);
 1190              		.loc 1 284 9
 1191 01e4 7021     		movs	r1, #112
 1192 01e6 1C48     		ldr	r0, .L70+20
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 27


 1193 01e8 FFF7FEFF 		bl	USART_SendData
 285:User/Src/OBDII.c ****         while(init_obd!=(temp+160));
 1194              		.loc 1 285 14
 1195 01ec 00BF     		nop
 1196              	.L67:
 1197              		.loc 1 285 23 discriminator 1
 1198 01ee 164B     		ldr	r3, .L70+4
 1199 01f0 1B88     		ldrh	r3, [r3]
 1200 01f2 1A46     		mov	r2, r3
 1201              		.loc 1 285 30 discriminator 1
 1202 01f4 FB8B     		ldrh	r3, [r7, #30]
 1203 01f6 A033     		adds	r3, r3, #160
 1204              		.loc 1 285 14 discriminator 1
 1205 01f8 9A42     		cmp	r2, r3
 1206 01fa F8D1     		bne	.L67
 286:User/Src/OBDII.c **** 
 287:User/Src/OBDII.c ****         while (USART_GetFlagStatus(USART1, USART_FLAG_TC) == RESET);
 1207              		.loc 1 287 15
 1208 01fc 00BF     		nop
 1209              	.L68:
 1210              		.loc 1 287 16 discriminator 1
 1211 01fe 4021     		movs	r1, #64
 1212 0200 1548     		ldr	r0, .L70+20
 1213 0202 FFF7FEFF 		bl	USART_GetFlagStatus
 1214 0206 0346     		mov	r3, r0
 1215              		.loc 1 287 15 discriminator 1
 1216 0208 002B     		cmp	r3, #0
 1217 020a F8D0     		beq	.L68
 288:User/Src/OBDII.c ****         USART_SendData(USART1,0xcc);
 1218              		.loc 1 288 9
 1219 020c CC21     		movs	r1, #204
 1220 020e 1248     		ldr	r0, .L70+20
 1221 0210 FFF7FEFF 		bl	USART_SendData
 289:User/Src/OBDII.c ****         while(init_obd!=(temp+760));
 1222              		.loc 1 289 14
 1223 0214 00BF     		nop
 1224              	.L69:
 1225              		.loc 1 289 23 discriminator 1
 1226 0216 0C4B     		ldr	r3, .L70+4
 1227 0218 1B88     		ldrh	r3, [r3]
 1228 021a 1A46     		mov	r2, r3
 1229              		.loc 1 289 30 discriminator 1
 1230 021c FB8B     		ldrh	r3, [r7, #30]
 1231 021e 03F53E73 		add	r3, r3, #760
 1232              		.loc 1 289 14 discriminator 1
 1233 0222 9A42     		cmp	r2, r3
 1234 0224 F7D1     		bne	.L69
 290:User/Src/OBDII.c **** 		obd_count=0;
 1235              		.loc 1 290 12
 1236 0226 0A4B     		ldr	r3, .L70+12
 1237 0228 0022     		movs	r2, #0
 1238 022a 1A70     		strb	r2, [r3]
 1239              	.L64:
 291:User/Src/OBDII.c **** 	}
 292:User/Src/OBDII.c **** 
 293:User/Src/OBDII.c **** 
 294:User/Src/OBDII.c **** 	TIM_DeInit(TIM2);
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 28


 1240              		.loc 1 294 2
 1241 022c 4FF08040 		mov	r0, #1073741824
 1242 0230 FFF7FEFF 		bl	TIM_DeInit
 295:User/Src/OBDII.c **** 	init_obd=0;
 1243              		.loc 1 295 10
 1244 0234 044B     		ldr	r3, .L70+4
 1245 0236 0022     		movs	r2, #0
 1246 0238 1A80     		strh	r2, [r3]	@ movhi
 296:User/Src/OBDII.c **** }
 1247              		.loc 1 296 1
 1248 023a 00BF     		nop
 1249 023c 2037     		adds	r7, r7, #32
 1250              	.LCFI23:
 1251              		.cfi_def_cfa_offset 8
 1252 023e BD46     		mov	sp, r7
 1253              	.LCFI24:
 1254              		.cfi_def_cfa_register 13
 1255              		@ sp needed
 1256 0240 80BD     		pop	{r7, pc}
 1257              	.L71:
 1258 0242 00BF     		.align	2
 1259              	.L70:
 1260 0244 00000240 		.word	1073872896
 1261 0248 00000000 		.word	init_obd
 1262 024c 00080240 		.word	1073874944
 1263 0250 00000000 		.word	obd_count
 1264 0254 00000000 		.word	OBD_RCV_T
 1265 0258 00100140 		.word	1073811456
 1266              		.cfi_endproc
 1267              	.LFE139:
 1269              		.section	.text.K_line_fast_init,"ax",%progbits
 1270              		.align	1
 1271              		.global	K_line_fast_init
 1272              		.syntax unified
 1273              		.thumb
 1274              		.thumb_func
 1276              	K_line_fast_init:
 1277              	.LFB140:
 297:User/Src/OBDII.c **** 
 298:User/Src/OBDII.c **** /*******************************************************************************
 299:User/Src/OBDII.c **** * Function Name  : K_line_fast_init
 300:User/Src/OBDII.c **** * Description    : fast init method serial protocol (ISO 9141-2)
 301:User/Src/OBDII.c **** * Input          : None
 302:User/Src/OBDII.c **** * Output         : None
 303:User/Src/OBDII.c **** * Return         : None
 304:User/Src/OBDII.c **** *******************************************************************************/	
 305:User/Src/OBDII.c **** void K_line_fast_init(void)
 306:User/Src/OBDII.c **** { 
 1278              		.loc 1 306 1
 1279              		.cfi_startproc
 1280              		@ args = 0, pretend = 0, frame = 32
 1281              		@ frame_needed = 1, uses_anonymous_args = 0
 1282 0000 80B5     		push	{r7, lr}
 1283              	.LCFI25:
 1284              		.cfi_def_cfa_offset 8
 1285              		.cfi_offset 7, -8
 1286              		.cfi_offset 14, -4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 29


 1287 0002 88B0     		sub	sp, sp, #32
 1288              	.LCFI26:
 1289              		.cfi_def_cfa_offset 40
 1290 0004 00AF     		add	r7, sp, #0
 1291              	.LCFI27:
 1292              		.cfi_def_cfa_register 7
 307:User/Src/OBDII.c **** 	GPIO_InitTypeDef GPIO_InitStructure;	
 308:User/Src/OBDII.c ****     uint16_t temp=0;
 1293              		.loc 1 308 14
 1294 0006 0023     		movs	r3, #0
 1295 0008 FB83     		strh	r3, [r7, #30]	@ movhi
 309:User/Src/OBDII.c **** 	TIM_TimeBaseInitTypeDef  TIM_TimeBaseStructure;
 310:User/Src/OBDII.c **** 	NVIC_InitTypeDef NVIC_InitStructure; 
 311:User/Src/OBDII.c **** 
 312:User/Src/OBDII.c **** 	RCC_APB2PeriphClockCmd(RCC_AHB1Periph_GPIOA, ENABLE);
 1296              		.loc 1 312 2
 1297 000a 0121     		movs	r1, #1
 1298 000c 0120     		movs	r0, #1
 1299 000e FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 313:User/Src/OBDII.c **** 
 314:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOA, GPIO_Pin_9);
 1300              		.loc 1 314 2
 1301 0012 4FF40071 		mov	r1, #512
 1302 0016 4F48     		ldr	r0, .L76
 1303 0018 FFF7FEFF 		bl	GPIO_SetBits
 315:User/Src/OBDII.c **** 	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;	         
 1304              		.loc 1 315 30
 1305 001c 4FF40073 		mov	r3, #512
 1306 0020 7B61     		str	r3, [r7, #20]
 316:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
 1307              		.loc 1 316 34
 1308 0022 0123     		movs	r3, #1
 1309 0024 3B76     		strb	r3, [r7, #24]
 317:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 1310              		.loc 1 317 35
 1311 0026 0023     		movs	r3, #0
 1312 0028 BB76     		strb	r3, [r7, #26]
 318:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 1313              		.loc 1 318 34
 1314 002a 0023     		movs	r3, #0
 1315 002c FB76     		strb	r3, [r7, #27]
 319:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 1316              		.loc 1 319 35
 1317 002e 0223     		movs	r3, #2
 1318 0030 7B76     		strb	r3, [r7, #25]
 320:User/Src/OBDII.c **** 
 321:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);	
 1319              		.loc 1 321 5
 1320 0032 07F11403 		add	r3, r7, #20
 1321 0036 1946     		mov	r1, r3
 1322 0038 4648     		ldr	r0, .L76
 1323 003a FFF7FEFF 		bl	GPIO_Init
 322:User/Src/OBDII.c **** 
 323:User/Src/OBDII.c ****  	GPIO_ResetBits(GPIOC,GPIO_Pin_13);
 1324              		.loc 1 323 3
 1325 003e 4FF40051 		mov	r1, #8192
 1326 0042 4548     		ldr	r0, .L76+4
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 30


 1327 0044 FFF7FEFF 		bl	GPIO_ResetBits
 324:User/Src/OBDII.c **** 		
 325:User/Src/OBDII.c **** 	RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2 , ENABLE);
 1328              		.loc 1 325 2
 1329 0048 0121     		movs	r1, #1
 1330 004a 0120     		movs	r0, #1
 1331 004c FFF7FEFF 		bl	RCC_APB1PeriphClockCmd
 326:User/Src/OBDII.c ****     TIM_DeInit(TIM2);
 1332              		.loc 1 326 5
 1333 0050 4FF08040 		mov	r0, #1073741824
 1334 0054 FFF7FEFF 		bl	TIM_DeInit
 327:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_Period=1000;
 1335              		.loc 1 327 37
 1336 0058 4FF47A73 		mov	r3, #1000
 1337 005c FB60     		str	r3, [r7, #12]
 328:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_Prescaler= (36 - 1);		
 1338              		.loc 1 328 40
 1339 005e 2323     		movs	r3, #35
 1340 0060 3B81     		strh	r3, [r7, #8]	@ movhi
 329:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_ClockDivision = TIM_CKD_DIV1; 		
 1341              		.loc 1 329 45
 1342 0062 0023     		movs	r3, #0
 1343 0064 3B82     		strh	r3, [r7, #16]	@ movhi
 330:User/Src/OBDII.c ****     TIM_TimeBaseStructure.TIM_CounterMode = TIM_CounterMode_Up; 	
 1344              		.loc 1 330 43
 1345 0066 0023     		movs	r3, #0
 1346 0068 7B81     		strh	r3, [r7, #10]	@ movhi
 331:User/Src/OBDII.c ****     TIM_TimeBaseInit(TIM2, &TIM_TimeBaseStructure);
 1347              		.loc 1 331 5
 1348 006a 07F10803 		add	r3, r7, #8
 1349 006e 1946     		mov	r1, r3
 1350 0070 4FF08040 		mov	r0, #1073741824
 1351 0074 FFF7FEFF 		bl	TIM_TimeBaseInit
 332:User/Src/OBDII.c ****     TIM_ClearFlag(TIM2, TIM_FLAG_Update);							 
 1352              		.loc 1 332 5
 1353 0078 0121     		movs	r1, #1
 1354 007a 4FF08040 		mov	r0, #1073741824
 1355 007e FFF7FEFF 		bl	TIM_ClearFlag
 333:User/Src/OBDII.c ****     TIM_ITConfig(TIM2,TIM_IT_Update,ENABLE);
 1356              		.loc 1 333 5
 1357 0082 0122     		movs	r2, #1
 1358 0084 0121     		movs	r1, #1
 1359 0086 4FF08040 		mov	r0, #1073741824
 1360 008a FFF7FEFF 		bl	TIM_ITConfig
 334:User/Src/OBDII.c ****     TIM_Cmd(TIM2, ENABLE);	
 1361              		.loc 1 334 5
 1362 008e 0121     		movs	r1, #1
 1363 0090 4FF08040 		mov	r0, #1073741824
 1364 0094 FFF7FEFF 		bl	TIM_Cmd
 335:User/Src/OBDII.c **** 
 336:User/Src/OBDII.c ****     NVIC_PriorityGroupConfig(NVIC_PriorityGroup_0);  													
 1365              		.loc 1 336 5
 1366 0098 4FF4E060 		mov	r0, #1792
 1367 009c FFF7FEFF 		bl	NVIC_PriorityGroupConfig
 337:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;	  
 1368              		.loc 1 337 40
 1369 00a0 1C23     		movs	r3, #28
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 31


 1370 00a2 3B71     		strb	r3, [r7, #4]
 338:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 1371              		.loc 1 338 58
 1372 00a4 0023     		movs	r3, #0
 1373 00a6 7B71     		strb	r3, [r7, #5]
 339:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;	
 1374              		.loc 1 339 51
 1375 00a8 0023     		movs	r3, #0
 1376 00aa BB71     		strb	r3, [r7, #6]
 340:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 1377              		.loc 1 340 43
 1378 00ac 0123     		movs	r3, #1
 1379 00ae FB71     		strb	r3, [r7, #7]
 341:User/Src/OBDII.c ****     NVIC_Init(&NVIC_InitStructure);	
 1380              		.loc 1 341 5
 1381 00b0 3B1D     		adds	r3, r7, #4
 1382 00b2 1846     		mov	r0, r3
 1383 00b4 FFF7FEFF 		bl	NVIC_Init
 342:User/Src/OBDII.c **** 		
 343:User/Src/OBDII.c **** 	while(init_obd!=600);
 1384              		.loc 1 343 7
 1385 00b8 00BF     		nop
 1386              	.L73:
 1387              		.loc 1 343 16 discriminator 1
 1388 00ba 284B     		ldr	r3, .L76+8
 1389 00bc 1B88     		ldrh	r3, [r3]
 1390              		.loc 1 343 7 discriminator 1
 1391 00be B3F5167F 		cmp	r3, #600
 1392 00c2 FAD1     		bne	.L73
 344:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOA,GPIO_Pin_9);
 1393              		.loc 1 344 2
 1394 00c4 4FF40071 		mov	r1, #512
 1395 00c8 2248     		ldr	r0, .L76
 1396 00ca FFF7FEFF 		bl	GPIO_ResetBits
 345:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOC,GPIO_Pin_13);
 1397              		.loc 1 345 2
 1398 00ce 4FF40051 		mov	r1, #8192
 1399 00d2 2148     		ldr	r0, .L76+4
 1400 00d4 FFF7FEFF 		bl	GPIO_SetBits
 346:User/Src/OBDII.c **** 	while(init_obd!=650);
 1401              		.loc 1 346 7
 1402 00d8 00BF     		nop
 1403              	.L74:
 1404              		.loc 1 346 16 discriminator 1
 1405 00da 204B     		ldr	r3, .L76+8
 1406 00dc 1B88     		ldrh	r3, [r3]
 1407              		.loc 1 346 7 discriminator 1
 1408 00de 40F28A22 		movw	r2, #650
 1409 00e2 9342     		cmp	r3, r2
 1410 00e4 F9D1     		bne	.L74
 347:User/Src/OBDII.c **** 	GPIO_SetBits(GPIOA,GPIO_Pin_9);
 1411              		.loc 1 347 2
 1412 00e6 4FF40071 		mov	r1, #512
 1413 00ea 1A48     		ldr	r0, .L76
 1414 00ec FFF7FEFF 		bl	GPIO_SetBits
 348:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOC,GPIO_Pin_13);
 1415              		.loc 1 348 2
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 32


 1416 00f0 4FF40051 		mov	r1, #8192
 1417 00f4 1848     		ldr	r0, .L76+4
 1418 00f6 FFF7FEFF 		bl	GPIO_ResetBits
 349:User/Src/OBDII.c **** 	while(init_obd!=700);
 1419              		.loc 1 349 7
 1420 00fa 00BF     		nop
 1421              	.L75:
 1422              		.loc 1 349 16 discriminator 1
 1423 00fc 174B     		ldr	r3, .L76+8
 1424 00fe 1B88     		ldrh	r3, [r3]
 1425              		.loc 1 349 7 discriminator 1
 1426 0100 B3F52F7F 		cmp	r3, #700
 1427 0104 FAD1     		bne	.L75
 350:User/Src/OBDII.c **** 
 351:User/Src/OBDII.c **** 	GPIO_ResetBits(GPIOC,GPIO_Pin_13);
 1428              		.loc 1 351 2
 1429 0106 4FF40051 		mov	r1, #8192
 1430 010a 1348     		ldr	r0, .L76+4
 1431 010c FFF7FEFF 		bl	GPIO_ResetBits
 352:User/Src/OBDII.c **** 	
 353:User/Src/OBDII.c **** 	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;	         
 1432              		.loc 1 353 30
 1433 0110 4FF40073 		mov	r3, #512
 1434 0114 7B61     		str	r3, [r7, #20]
 354:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 1435              		.loc 1 354 34
 1436 0116 0223     		movs	r3, #2
 1437 0118 3B76     		strb	r3, [r7, #24]
 355:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 1438              		.loc 1 355 35
 1439 011a 0023     		movs	r3, #0
 1440 011c BB76     		strb	r3, [r7, #26]
 356:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 1441              		.loc 1 356 34
 1442 011e 0023     		movs	r3, #0
 1443 0120 FB76     		strb	r3, [r7, #27]
 357:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 1444              		.loc 1 357 35
 1445 0122 0223     		movs	r3, #2
 1446 0124 7B76     		strb	r3, [r7, #25]
 358:User/Src/OBDII.c **** 
 359:User/Src/OBDII.c ****     GPIO_PinAFConfig(GPIOA, GPIO_PinSource9, GPIO_AF_USART1);
 1447              		.loc 1 359 5
 1448 0126 0722     		movs	r2, #7
 1449 0128 0921     		movs	r1, #9
 1450 012a 0A48     		ldr	r0, .L76
 1451 012c FFF7FEFF 		bl	GPIO_PinAFConfig
 360:User/Src/OBDII.c **** 
 361:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);		 
 1452              		.loc 1 361 5
 1453 0130 07F11403 		add	r3, r7, #20
 1454 0134 1946     		mov	r1, r3
 1455 0136 0748     		ldr	r0, .L76
 1456 0138 FFF7FEFF 		bl	GPIO_Init
 362:User/Src/OBDII.c **** 	TIM_DeInit(TIM2);
 1457              		.loc 1 362 2
 1458 013c 4FF08040 		mov	r0, #1073741824
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 33


 1459 0140 FFF7FEFF 		bl	TIM_DeInit
 363:User/Src/OBDII.c **** 	init_obd=0;
 1460              		.loc 1 363 10
 1461 0144 054B     		ldr	r3, .L76+8
 1462 0146 0022     		movs	r2, #0
 1463 0148 1A80     		strh	r2, [r3]	@ movhi
 364:User/Src/OBDII.c **** }	
 1464              		.loc 1 364 1
 1465 014a 00BF     		nop
 1466 014c 2037     		adds	r7, r7, #32
 1467              	.LCFI28:
 1468              		.cfi_def_cfa_offset 8
 1469 014e BD46     		mov	sp, r7
 1470              	.LCFI29:
 1471              		.cfi_def_cfa_register 13
 1472              		@ sp needed
 1473 0150 80BD     		pop	{r7, pc}
 1474              	.L77:
 1475 0152 00BF     		.align	2
 1476              	.L76:
 1477 0154 00000240 		.word	1073872896
 1478 0158 00080240 		.word	1073874944
 1479 015c 00000000 		.word	init_obd
 1480              		.cfi_endproc
 1481              	.LFE140:
 1483              		.section	.rodata
 1484              		.align	2
 1485              	.LC0:
 1486 0000 02010000 		.ascii	"\002\001\000\000\000\000\000\000"
 1486      00000000 
 1487              		.align	2
 1488              	.LC1:
 1489 0008 02014600 		.ascii	"\002\001F\000\000\000\000\000"
 1489      00000000 
 1490              		.align	2
 1491              	.LC2:
 1492 0010 00000000 		.ascii	"\000\000\000\000\000\000\000\000"
 1492      00000000 
 1493              		.section	.text.OBD_ecu_Init,"ax",%progbits
 1494              		.align	1
 1495              		.global	OBD_ecu_Init
 1496              		.syntax unified
 1497              		.thumb
 1498              		.thumb_func
 1500              	OBD_ecu_Init:
 1501              	.LFB141:
 365:User/Src/OBDII.c **** 
 366:User/Src/OBDII.c **** 
 367:User/Src/OBDII.c **** /*******************************************************************************
 368:User/Src/OBDII.c **** * Function Name  : OBD_ecu_Init
 369:User/Src/OBDII.c **** * Description    : select obdii init method (slow ISO 9141-2 , or fast ISO 9141-2,ISO 15765  )
 370:User/Src/OBDII.c **** * Input          : None
 371:User/Src/OBDII.c **** * Output         : None
 372:User/Src/OBDII.c **** * Return         : None
 373:User/Src/OBDII.c **** *******************************************************************************/	
 374:User/Src/OBDII.c **** void OBD_ecu_Init(void)
 375:User/Src/OBDII.c **** {
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 34


 1502              		.loc 1 375 1
 1503              		.cfi_startproc
 1504              		@ args = 0, pretend = 0, frame = 40
 1505              		@ frame_needed = 1, uses_anonymous_args = 0
 1506 0000 80B5     		push	{r7, lr}
 1507              	.LCFI30:
 1508              		.cfi_def_cfa_offset 8
 1509              		.cfi_offset 7, -8
 1510              		.cfi_offset 14, -4
 1511 0002 8AB0     		sub	sp, sp, #40
 1512              	.LCFI31:
 1513              		.cfi_def_cfa_offset 48
 1514 0004 00AF     		add	r7, sp, #0
 1515              	.LCFI32:
 1516              		.cfi_def_cfa_register 7
 376:User/Src/OBDII.c **** 	uint8_t size_R = 0;	
 1517              		.loc 1 376 10
 1518 0006 0023     		movs	r3, #0
 1519 0008 87F82530 		strb	r3, [r7, #37]
 377:User/Src/OBDII.c **** 	uint8_t Data1[2] = {0x1,0x0c};	
 1520              		.loc 1 377 10
 1521 000c 40F60143 		movw	r3, #3073
 1522 0010 3B84     		strh	r3, [r7, #32]	@ movhi
 378:User/Src/OBDII.c **** 	uint8_t Data2[4] = {0,0,0,0};
 1523              		.loc 1 378 10
 1524 0012 0023     		movs	r3, #0
 1525 0014 FB61     		str	r3, [r7, #28]
 379:User/Src/OBDII.c ****     uint8_t Data3[8] = {2,1,0,0,0,0,0,0};
 1526              		.loc 1 379 13
 1527 0016 524A     		ldr	r2, .L86
 1528 0018 07F11403 		add	r3, r7, #20
 1529 001c 92E80300 		ldm	r2, {r0, r1}
 1530 0020 83E80300 		stm	r3, {r0, r1}
 380:User/Src/OBDII.c ****     uint8_t Data4[8] = {2,1,0x46,0,0,0,0,0};
 1531              		.loc 1 380 13
 1532 0024 4F4A     		ldr	r2, .L86+4
 1533 0026 07F10C03 		add	r3, r7, #12
 1534 002a 92E80300 		ldm	r2, {r0, r1}
 1535 002e 83E80300 		stm	r3, {r0, r1}
 381:User/Src/OBDII.c ****     uint8_t Data5[8] = {0,0,0,0,0,0,0,0};
 1536              		.loc 1 381 13
 1537 0032 4D4A     		ldr	r2, .L86+8
 1538 0034 3B1D     		adds	r3, r7, #4
 1539 0036 92E80300 		ldm	r2, {r0, r1}
 1540 003a 83E80300 		stm	r3, {r0, r1}
 382:User/Src/OBDII.c **** 	uint8_t test_ecu = 0;		
 1541              		.loc 1 382 10
 1542 003e 0023     		movs	r3, #0
 1543 0040 87F82730 		strb	r3, [r7, #39]
 383:User/Src/OBDII.c **** 	uint8_t init = 0;
 1544              		.loc 1 383 10
 1545 0044 0023     		movs	r3, #0
 1546 0046 87F82630 		strb	r3, [r7, #38]
 384:User/Src/OBDII.c ****     while(init == 0)
 1547              		.loc 1 384 10
 1548 004a 7FE0     		b	.L79
 1549              	.L85:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 35


 385:User/Src/OBDII.c ****     {
 386:User/Src/OBDII.c ****         vTaskDelay(5000);
 1550              		.loc 1 386 9
 1551 004c 41F28830 		movw	r0, #5000
 1552 0050 FFF7FEFF 		bl	vTaskDelay
 387:User/Src/OBDII.c ****         if(obd_turn_on == 1)
 1553              		.loc 1 387 24
 1554 0054 454B     		ldr	r3, .L86+12
 1555 0056 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1556              		.loc 1 387 11
 1557 0058 012B     		cmp	r3, #1
 1558 005a 6BD1     		bne	.L80
 388:User/Src/OBDII.c ****         {				
 389:User/Src/OBDII.c ****             K_line_fast_init();
 1559              		.loc 1 389 13
 1560 005c FFF7FEFF 		bl	K_line_fast_init
 390:User/Src/OBDII.c ****             Data1[0] = 0x81;
 1561              		.loc 1 390 22
 1562 0060 8123     		movs	r3, #129
 1563 0062 87F82030 		strb	r3, [r7, #32]
 391:User/Src/OBDII.c ****             Data1[1] = 0;
 1564              		.loc 1 391 22
 1565 0066 0023     		movs	r3, #0
 1566 0068 87F82130 		strb	r3, [r7, #33]
 392:User/Src/OBDII.c ****             OBD_Send_Recive_ecu(Data1,1,Data2,&size_R);
 1567              		.loc 1 392 13
 1568 006c 07F12503 		add	r3, r7, #37
 1569 0070 07F11C02 		add	r2, r7, #28
 1570 0074 07F12000 		add	r0, r7, #32
 1571 0078 0121     		movs	r1, #1
 1572 007a FFF7FEFF 		bl	OBD_Send_Recive_ecu
 393:User/Src/OBDII.c ****             //K_line_RCV(k_cmd2,&size_R);	
 394:User/Src/OBDII.c ****             if(size_R==3)
 1573              		.loc 1 394 22
 1574 007e 97F82530 		ldrb	r3, [r7, #37]	@ zero_extendqisi2
 1575              		.loc 1 394 15
 1576 0082 032B     		cmp	r3, #3
 1577 0084 06D1     		bne	.L81
 395:User/Src/OBDII.c ****             {
 396:User/Src/OBDII.c ****                 init=1;
 1578              		.loc 1 396 21
 1579 0086 0123     		movs	r3, #1
 1580 0088 87F82630 		strb	r3, [r7, #38]
 397:User/Src/OBDII.c ****                 flasg_t=KWP_Flag; 
 1581              		.loc 1 397 24
 1582 008c 384B     		ldr	r3, .L86+16
 1583 008e 0222     		movs	r2, #2
 1584 0090 1A70     		strb	r2, [r3]
 398:User/Src/OBDII.c ****                 break;
 1585              		.loc 1 398 17
 1586 0092 61E0     		b	.L82
 1587              	.L81:
 399:User/Src/OBDII.c ****             }else{
 400:User/Src/OBDII.c ****                 vTaskDelay(1000);
 1588              		.loc 1 400 17
 1589 0094 4FF47A70 		mov	r0, #1000
 1590 0098 FFF7FEFF 		bl	vTaskDelay
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 36


 401:User/Src/OBDII.c ****                 K_line_slow_init();
 1591              		.loc 1 401 17
 1592 009c FFF7FEFF 		bl	K_line_slow_init
 402:User/Src/OBDII.c ****                 Data1[0] = 0x01;
 1593              		.loc 1 402 26
 1594 00a0 0123     		movs	r3, #1
 1595 00a2 87F82030 		strb	r3, [r7, #32]
 403:User/Src/OBDII.c ****                 Data1[1] = 0x0C;
 1596              		.loc 1 403 26
 1597 00a6 0C23     		movs	r3, #12
 1598 00a8 87F82130 		strb	r3, [r7, #33]
 404:User/Src/OBDII.c ****                 OBD_Send_Recive_ecu(Data1,2,Data2,&size_R);			
 1599              		.loc 1 404 17
 1600 00ac 07F12503 		add	r3, r7, #37
 1601 00b0 07F11C02 		add	r2, r7, #28
 1602 00b4 07F12000 		add	r0, r7, #32
 1603 00b8 0221     		movs	r1, #2
 1604 00ba FFF7FEFF 		bl	OBD_Send_Recive_ecu
 405:User/Src/OBDII.c ****                 if(size_R==4)
 1605              		.loc 1 405 26
 1606 00be 97F82530 		ldrb	r3, [r7, #37]	@ zero_extendqisi2
 1607              		.loc 1 405 19
 1608 00c2 042B     		cmp	r3, #4
 1609 00c4 06D1     		bne	.L83
 406:User/Src/OBDII.c ****                 {
 407:User/Src/OBDII.c ****                     init=1;
 1610              		.loc 1 407 25
 1611 00c6 0123     		movs	r3, #1
 1612 00c8 87F82630 		strb	r3, [r7, #38]
 408:User/Src/OBDII.c ****                     flasg_t=KWP_Flag; 
 1613              		.loc 1 408 28
 1614 00cc 284B     		ldr	r3, .L86+16
 1615 00ce 0222     		movs	r2, #2
 1616 00d0 1A70     		strb	r2, [r3]
 409:User/Src/OBDII.c ****                     break;
 1617              		.loc 1 409 21
 1618 00d2 41E0     		b	.L82
 1619              	.L83:
 410:User/Src/OBDII.c ****                 }
 411:User/Src/OBDII.c ****                 if(can_send(0x7DF,8,Data3))
 1620              		.loc 1 411 20
 1621 00d4 07F11403 		add	r3, r7, #20
 1622 00d8 1A46     		mov	r2, r3
 1623 00da 0821     		movs	r1, #8
 1624 00dc 40F2DF70 		movw	r0, #2015
 1625 00e0 FFF7FEFF 		bl	can_send
 1626 00e4 0346     		mov	r3, r0
 1627              		.loc 1 411 19
 1628 00e6 002B     		cmp	r3, #0
 1629 00e8 1FD0     		beq	.L84
 412:User/Src/OBDII.c ****                 {
 413:User/Src/OBDII.c ****                     vTaskDelay(1000);
 1630              		.loc 1 413 21
 1631 00ea 4FF47A70 		mov	r0, #1000
 1632 00ee FFF7FEFF 		bl	vTaskDelay
 414:User/Src/OBDII.c ****                     if(can_send(0x7DF, 8, Data4))
 1633              		.loc 1 414 24
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 37


 1634 00f2 07F10C03 		add	r3, r7, #12
 1635 00f6 1A46     		mov	r2, r3
 1636 00f8 0821     		movs	r1, #8
 1637 00fa 40F2DF70 		movw	r0, #2015
 1638 00fe FFF7FEFF 		bl	can_send
 1639 0102 0346     		mov	r3, r0
 1640              		.loc 1 414 23
 1641 0104 002B     		cmp	r3, #0
 1642 0106 10D0     		beq	.L84
 415:User/Src/OBDII.c ****                     if(can_rcv(&size_R, Data5))
 1643              		.loc 1 415 24
 1644 0108 3A1D     		adds	r2, r7, #4
 1645 010a 07F12503 		add	r3, r7, #37
 1646 010e 1146     		mov	r1, r2
 1647 0110 1846     		mov	r0, r3
 1648 0112 FFF7FEFF 		bl	can_rcv
 1649 0116 0346     		mov	r3, r0
 1650              		.loc 1 415 23
 1651 0118 002B     		cmp	r3, #0
 1652 011a 06D0     		beq	.L84
 416:User/Src/OBDII.c ****                     {
 417:User/Src/OBDII.c ****                         init=1;
 1653              		.loc 1 417 29
 1654 011c 0123     		movs	r3, #1
 1655 011e 87F82630 		strb	r3, [r7, #38]
 418:User/Src/OBDII.c ****                         flasg_t=CAN_Flag; 
 1656              		.loc 1 418 32
 1657 0122 134B     		ldr	r3, .L86+16
 1658 0124 0122     		movs	r2, #1
 1659 0126 1A70     		strb	r2, [r3]
 419:User/Src/OBDII.c ****                         break;
 1660              		.loc 1 419 25
 1661 0128 16E0     		b	.L82
 1662              	.L84:
 420:User/Src/OBDII.c ****                     }
 421:User/Src/OBDII.c ****                 }
 422:User/Src/OBDII.c **** 
 423:User/Src/OBDII.c ****                 test_ecu++;
 1663              		.loc 1 423 25
 1664 012a 97F82730 		ldrb	r3, [r7, #39]	@ zero_extendqisi2
 1665 012e 0133     		adds	r3, r3, #1
 1666 0130 87F82730 		strb	r3, [r7, #39]
 1667              	.L80:
 424:User/Src/OBDII.c ****             }
 425:User/Src/OBDII.c ****         }
 426:User/Src/OBDII.c ****             if (test_ecu>1)
 1668              		.loc 1 426 16
 1669 0134 97F82730 		ldrb	r3, [r7, #39]	@ zero_extendqisi2
 1670 0138 012B     		cmp	r3, #1
 1671 013a 07D9     		bls	.L79
 427:User/Src/OBDII.c ****             {
 428:User/Src/OBDII.c ****             obd_turn_on=0;
 1672              		.loc 1 428 24
 1673 013c 0B4B     		ldr	r3, .L86+12
 1674 013e 0022     		movs	r2, #0
 1675 0140 1A70     		strb	r2, [r3]
 429:User/Src/OBDII.c ****             bus_off();
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 38


 1676              		.loc 1 429 13
 1677 0142 FFF7FEFF 		bl	bus_off
 430:User/Src/OBDII.c ****             test_ecu=0;
 1678              		.loc 1 430 21
 1679 0146 0023     		movs	r3, #0
 1680 0148 87F82730 		strb	r3, [r7, #39]
 1681              	.L79:
 384:User/Src/OBDII.c ****     {
 1682              		.loc 1 384 10
 1683 014c 97F82630 		ldrb	r3, [r7, #38]	@ zero_extendqisi2
 1684 0150 002B     		cmp	r3, #0
 1685 0152 3FF47BAF 		beq	.L85
 431:User/Src/OBDII.c ****         }
 432:User/Src/OBDII.c ****         
 433:User/Src/OBDII.c ****     }
 434:User/Src/OBDII.c **** }
 1686              		.loc 1 434 1
 1687 0156 00BF     		nop
 1688              	.L82:
 1689 0158 00BF     		nop
 1690 015a 2837     		adds	r7, r7, #40
 1691              	.LCFI33:
 1692              		.cfi_def_cfa_offset 8
 1693 015c BD46     		mov	sp, r7
 1694              	.LCFI34:
 1695              		.cfi_def_cfa_register 13
 1696              		@ sp needed
 1697 015e 80BD     		pop	{r7, pc}
 1698              	.L87:
 1699              		.align	2
 1700              	.L86:
 1701 0160 00000000 		.word	.LC0
 1702 0164 08000000 		.word	.LC1
 1703 0168 10000000 		.word	.LC2
 1704 016c 00000000 		.word	obd_turn_on
 1705 0170 00000000 		.word	flasg_t
 1706              		.cfi_endproc
 1707              	.LFE141:
 1709              		.section	.text.OBD_Send_Recive_ecu,"ax",%progbits
 1710              		.align	1
 1711              		.global	OBD_Send_Recive_ecu
 1712              		.syntax unified
 1713              		.thumb
 1714              		.thumb_func
 1716              	OBD_Send_Recive_ecu:
 1717              	.LFB142:
 435:User/Src/OBDII.c **** 
 436:User/Src/OBDII.c **** /*******************************************************************************
 437:User/Src/OBDII.c **** * Function Name  : OBD_Send_Recive_ecu
 438:User/Src/OBDII.c **** * Description    : send and Recive OBDII data high layer
 439:User/Src/OBDII.c **** * Input          : send_buf,send_buf_s,rcv_buf,rcv_buf_s
 440:User/Src/OBDII.c **** * Output         : None
 441:User/Src/OBDII.c **** * Return         : None
 442:User/Src/OBDII.c **** *******************************************************************************/	
 443:User/Src/OBDII.c **** uint8_t OBD_Send_Recive_ecu(uint8_t *send_buf,uint8_t send_buf_s,uint8_t *rcv_buf,uint8_t *rcv_buf_
 444:User/Src/OBDII.c **** {
 1718              		.loc 1 444 1
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 39


 1719              		.cfi_startproc
 1720              		@ args = 0, pretend = 0, frame = 24
 1721              		@ frame_needed = 1, uses_anonymous_args = 0
 1722 0000 90B5     		push	{r4, r7, lr}
 1723              	.LCFI35:
 1724              		.cfi_def_cfa_offset 12
 1725              		.cfi_offset 4, -12
 1726              		.cfi_offset 7, -8
 1727              		.cfi_offset 14, -4
 1728 0002 87B0     		sub	sp, sp, #28
 1729              	.LCFI36:
 1730              		.cfi_def_cfa_offset 40
 1731 0004 00AF     		add	r7, sp, #0
 1732              	.LCFI37:
 1733              		.cfi_def_cfa_register 7
 1734 0006 F860     		str	r0, [r7, #12]
 1735 0008 7A60     		str	r2, [r7, #4]
 1736 000a 3B60     		str	r3, [r7]
 1737 000c 0B46     		mov	r3, r1
 1738 000e FB72     		strb	r3, [r7, #11]
 445:User/Src/OBDII.c **** 	uint32_t time_R=0;
 1739              		.loc 1 445 11
 1740 0010 0023     		movs	r3, #0
 1741 0012 7B61     		str	r3, [r7, #20]
 446:User/Src/OBDII.c ****     static uint8_t ecu_fail=0;
 447:User/Src/OBDII.c **** 
 448:User/Src/OBDII.c ****     K_line_send(send_buf, send_buf_s);
 1742              		.loc 1 448 5
 1743 0014 FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 1744 0016 1946     		mov	r1, r3
 1745 0018 F868     		ldr	r0, [r7, #12]
 1746 001a FFF7FEFF 		bl	K_line_send
 449:User/Src/OBDII.c ****     while(((!obd_count)&(time_R < OBD_RSP_TIME_OUT_ecu))|(!dif_count_obd()))
 1747              		.loc 1 449 10
 1748 001e 05E0     		b	.L89
 1749              	.L90:
 450:User/Src/OBDII.c ****     {
 451:User/Src/OBDII.c ****         vTaskDelay(1);
 1750              		.loc 1 451 9
 1751 0020 0120     		movs	r0, #1
 1752 0022 FFF7FEFF 		bl	vTaskDelay
 452:User/Src/OBDII.c ****         time_R++;
 1753              		.loc 1 452 15
 1754 0026 7B69     		ldr	r3, [r7, #20]
 1755 0028 0133     		adds	r3, r3, #1
 1756 002a 7B61     		str	r3, [r7, #20]
 1757              	.L89:
 449:User/Src/OBDII.c ****     while(((!obd_count)&(time_R < OBD_RSP_TIME_OUT_ecu))|(!dif_count_obd()))
 1758              		.loc 1 449 24
 1759 002c 1A4B     		ldr	r3, .L94
 1760 002e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1761 0030 002B     		cmp	r3, #0
 1762 0032 0CBF     		ite	eq
 1763 0034 0123     		moveq	r3, #1
 1764 0036 0023     		movne	r3, #0
 1765 0038 DAB2     		uxtb	r2, r3
 1766 003a 7B69     		ldr	r3, [r7, #20]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 40


 1767 003c 41F28731 		movw	r1, #4999
 1768 0040 8B42     		cmp	r3, r1
 1769 0042 94BF     		ite	ls
 1770 0044 0123     		movls	r3, #1
 1771 0046 0023     		movhi	r3, #0
 1772 0048 DBB2     		uxtb	r3, r3
 1773 004a 1340     		ands	r3, r3, r2
 1774 004c DBB2     		uxtb	r3, r3
 1775 004e 1C46     		mov	r4, r3
 449:User/Src/OBDII.c ****     while(((!obd_count)&(time_R < OBD_RSP_TIME_OUT_ecu))|(!dif_count_obd()))
 1776              		.loc 1 449 60
 1777 0050 FFF7FEFF 		bl	dif_count_obd
 1778 0054 0346     		mov	r3, r0
 449:User/Src/OBDII.c ****     while(((!obd_count)&(time_R < OBD_RSP_TIME_OUT_ecu))|(!dif_count_obd()))
 1779              		.loc 1 449 59
 1780 0056 002B     		cmp	r3, #0
 1781 0058 0CBF     		ite	eq
 1782 005a 0123     		moveq	r3, #1
 1783 005c 0023     		movne	r3, #0
 1784 005e DBB2     		uxtb	r3, r3
 449:User/Src/OBDII.c ****     while(((!obd_count)&(time_R < OBD_RSP_TIME_OUT_ecu))|(!dif_count_obd()))
 1785              		.loc 1 449 57
 1786 0060 2343     		orrs	r3, r3, r4
 449:User/Src/OBDII.c ****     while(((!obd_count)&(time_R < OBD_RSP_TIME_OUT_ecu))|(!dif_count_obd()))
 1787              		.loc 1 449 10
 1788 0062 002B     		cmp	r3, #0
 1789 0064 DCD1     		bne	.L90
 453:User/Src/OBDII.c ****     }
 454:User/Src/OBDII.c **** 
 455:User/Src/OBDII.c ****     if(time_R == OBD_RSP_TIME_OUT)
 1790              		.loc 1 455 7
 1791 0066 7B69     		ldr	r3, [r7, #20]
 1792 0068 0C4A     		ldr	r2, .L94+4
 1793 006a 9342     		cmp	r3, r2
 1794 006c 01D1     		bne	.L91
 456:User/Src/OBDII.c ****     {		
 457:User/Src/OBDII.c ****         return TIME_OUT_ERROR;
 1795              		.loc 1 457 16
 1796 006e 0323     		movs	r3, #3
 1797 0070 0DE0     		b	.L92
 1798              	.L91:
 458:User/Src/OBDII.c ****     }
 459:User/Src/OBDII.c ****             
 460:User/Src/OBDII.c ****     ecu_fail=0;	
 1799              		.loc 1 460 13
 1800 0072 0B4B     		ldr	r3, .L94+8
 1801 0074 0022     		movs	r2, #0
 1802 0076 1A70     		strb	r2, [r3]
 461:User/Src/OBDII.c **** 	K_line_RCV(rcv_buf, &rcv_buf_s[0]);			
 1803              		.loc 1 461 2
 1804 0078 3968     		ldr	r1, [r7]
 1805 007a 7868     		ldr	r0, [r7, #4]
 1806 007c FFF7FEFF 		bl	K_line_RCV
 462:User/Src/OBDII.c **** 	
 463:User/Src/OBDII.c **** 	if(rcv_buf[0] == 0X7F)
 1807              		.loc 1 463 12
 1808 0080 7B68     		ldr	r3, [r7, #4]
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 41


 1809 0082 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1810              		.loc 1 463 4
 1811 0084 7F2B     		cmp	r3, #127
 1812 0086 01D1     		bne	.L93
 464:User/Src/OBDII.c **** 	    return RSP_ERROR;
 1813              		.loc 1 464 13
 1814 0088 0023     		movs	r3, #0
 1815 008a 00E0     		b	.L92
 1816              	.L93:
 465:User/Src/OBDII.c **** 	
 466:User/Src/OBDII.c **** 	return TURE_RSP;	
 1817              		.loc 1 466 9
 1818 008c 0123     		movs	r3, #1
 1819              	.L92:
 467:User/Src/OBDII.c **** }
 1820              		.loc 1 467 1
 1821 008e 1846     		mov	r0, r3
 1822 0090 1C37     		adds	r7, r7, #28
 1823              	.LCFI38:
 1824              		.cfi_def_cfa_offset 12
 1825 0092 BD46     		mov	sp, r7
 1826              	.LCFI39:
 1827              		.cfi_def_cfa_register 13
 1828              		@ sp needed
 1829 0094 90BD     		pop	{r4, r7, pc}
 1830              	.L95:
 1831 0096 00BF     		.align	2
 1832              	.L94:
 1833 0098 00000000 		.word	obd_count
 1834 009c FFFF2F00 		.word	3145727
 1835 00a0 00000000 		.word	ecu_fail.1
 1836              		.cfi_endproc
 1837              	.LFE142:
 1839              		.section	.text.OBD_Send_Recive,"ax",%progbits
 1840              		.align	1
 1841              		.global	OBD_Send_Recive
 1842              		.syntax unified
 1843              		.thumb
 1844              		.thumb_func
 1846              	OBD_Send_Recive:
 1847              	.LFB143:
 468:User/Src/OBDII.c **** 
 469:User/Src/OBDII.c **** /*******************************************************************************
 470:User/Src/OBDII.c **** * Function Name  : OBD_Send_Recive
 471:User/Src/OBDII.c **** * Description    : send and Recive OBDII data high layer
 472:User/Src/OBDII.c **** * Input          : send_buf,send_buf_s,rcv_buf,rcv_buf_s
 473:User/Src/OBDII.c **** * Output         : None
 474:User/Src/OBDII.c **** * Return         : None
 475:User/Src/OBDII.c **** *******************************************************************************/	
 476:User/Src/OBDII.c **** 	
 477:User/Src/OBDII.c **** uint8_t OBD_Send_Recive(uint8_t *send_buf,uint8_t send_buf_s,uint8_t *rcv_buf,uint8_t *rcv_buf_s )
 478:User/Src/OBDII.c **** {
 1848              		.loc 1 478 1
 1849              		.cfi_startproc
 1850              		@ args = 0, pretend = 0, frame = 32
 1851              		@ frame_needed = 1, uses_anonymous_args = 0
 1852 0000 90B5     		push	{r4, r7, lr}
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 42


 1853              	.LCFI40:
 1854              		.cfi_def_cfa_offset 12
 1855              		.cfi_offset 4, -12
 1856              		.cfi_offset 7, -8
 1857              		.cfi_offset 14, -4
 1858 0002 89B0     		sub	sp, sp, #36
 1859              	.LCFI41:
 1860              		.cfi_def_cfa_offset 48
 1861 0004 00AF     		add	r7, sp, #0
 1862              	.LCFI42:
 1863              		.cfi_def_cfa_register 7
 1864 0006 F860     		str	r0, [r7, #12]
 1865 0008 7A60     		str	r2, [r7, #4]
 1866 000a 3B60     		str	r3, [r7]
 1867 000c 0B46     		mov	r3, r1
 1868 000e FB72     		strb	r3, [r7, #11]
 479:User/Src/OBDII.c **** 	
 480:User/Src/OBDII.c ****     uint32_t time_R=0;
 1869              		.loc 1 480 14
 1870 0010 0023     		movs	r3, #0
 1871 0012 FB61     		str	r3, [r7, #28]
 481:User/Src/OBDII.c ****     static uint8_t ecu_fail=0;
 482:User/Src/OBDII.c ****     uint8_t c_data[8]={0,0,0,0,0,0,0,0};
 1872              		.loc 1 482 13
 1873 0014 4C4A     		ldr	r2, .L109
 1874 0016 07F11003 		add	r3, r7, #16
 1875 001a 92E80300 		ldm	r2, {r0, r1}
 1876 001e 83E80300 		stm	r3, {r0, r1}
 483:User/Src/OBDII.c ****     uint8_t i=0;
 1877              		.loc 1 483 13
 1878 0022 0023     		movs	r3, #0
 1879 0024 FB76     		strb	r3, [r7, #27]
 484:User/Src/OBDII.c **** 
 485:User/Src/OBDII.c ****     if(flasg_t == KWP_Flag)
 1880              		.loc 1 485 16
 1881 0026 494B     		ldr	r3, .L109+4
 1882 0028 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1883              		.loc 1 485 7
 1884 002a 022B     		cmp	r3, #2
 1885 002c 44D1     		bne	.L97
 486:User/Src/OBDII.c ****     {
 487:User/Src/OBDII.c ****         K_line_send(send_buf,send_buf_s);
 1886              		.loc 1 487 9
 1887 002e FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 1888 0030 1946     		mov	r1, r3
 1889 0032 F868     		ldr	r0, [r7, #12]
 1890 0034 FFF7FEFF 		bl	K_line_send
 488:User/Src/OBDII.c ****         while(((!obd_count)&(time_R<OBD_RSP_TIME_OUT))|(!dif_count_obd()))
 1891              		.loc 1 488 14
 1892 0038 05E0     		b	.L98
 1893              	.L99:
 489:User/Src/OBDII.c ****         {
 490:User/Src/OBDII.c ****             vTaskDelay(1);
 1894              		.loc 1 490 13
 1895 003a 0120     		movs	r0, #1
 1896 003c FFF7FEFF 		bl	vTaskDelay
 491:User/Src/OBDII.c ****             time_R++;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 43


 1897              		.loc 1 491 19
 1898 0040 FB69     		ldr	r3, [r7, #28]
 1899 0042 0133     		adds	r3, r3, #1
 1900 0044 FB61     		str	r3, [r7, #28]
 1901              	.L98:
 488:User/Src/OBDII.c ****         while(((!obd_count)&(time_R<OBD_RSP_TIME_OUT))|(!dif_count_obd()))
 1902              		.loc 1 488 28
 1903 0046 424B     		ldr	r3, .L109+8
 1904 0048 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1905 004a 002B     		cmp	r3, #0
 1906 004c 0CBF     		ite	eq
 1907 004e 0123     		moveq	r3, #1
 1908 0050 0023     		movne	r3, #0
 1909 0052 DAB2     		uxtb	r2, r3
 1910 0054 FB69     		ldr	r3, [r7, #28]
 1911 0056 3F49     		ldr	r1, .L109+12
 1912 0058 8B42     		cmp	r3, r1
 1913 005a 94BF     		ite	ls
 1914 005c 0123     		movls	r3, #1
 1915 005e 0023     		movhi	r3, #0
 1916 0060 DBB2     		uxtb	r3, r3
 1917 0062 1340     		ands	r3, r3, r2
 1918 0064 DBB2     		uxtb	r3, r3
 1919 0066 1C46     		mov	r4, r3
 488:User/Src/OBDII.c ****         while(((!obd_count)&(time_R<OBD_RSP_TIME_OUT))|(!dif_count_obd()))
 1920              		.loc 1 488 58
 1921 0068 FFF7FEFF 		bl	dif_count_obd
 1922 006c 0346     		mov	r3, r0
 488:User/Src/OBDII.c ****         while(((!obd_count)&(time_R<OBD_RSP_TIME_OUT))|(!dif_count_obd()))
 1923              		.loc 1 488 57
 1924 006e 002B     		cmp	r3, #0
 1925 0070 0CBF     		ite	eq
 1926 0072 0123     		moveq	r3, #1
 1927 0074 0023     		movne	r3, #0
 1928 0076 DBB2     		uxtb	r3, r3
 488:User/Src/OBDII.c ****         while(((!obd_count)&(time_R<OBD_RSP_TIME_OUT))|(!dif_count_obd()))
 1929              		.loc 1 488 55
 1930 0078 2343     		orrs	r3, r3, r4
 488:User/Src/OBDII.c ****         while(((!obd_count)&(time_R<OBD_RSP_TIME_OUT))|(!dif_count_obd()))
 1931              		.loc 1 488 14
 1932 007a 002B     		cmp	r3, #0
 1933 007c DDD1     		bne	.L99
 492:User/Src/OBDII.c ****         }
 493:User/Src/OBDII.c **** 
 494:User/Src/OBDII.c ****         if(time_R == OBD_RSP_TIME_OUT)
 1934              		.loc 1 494 11
 1935 007e FB69     		ldr	r3, [r7, #28]
 1936 0080 354A     		ldr	r2, .L109+16
 1937 0082 9342     		cmp	r3, r2
 1938 0084 10D1     		bne	.L100
 495:User/Src/OBDII.c ****         {		
 496:User/Src/OBDII.c ****             ecu_fail++;
 1939              		.loc 1 496 21
 1940 0086 354B     		ldr	r3, .L109+20
 1941 0088 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1942 008a 0133     		adds	r3, r3, #1
 1943 008c DAB2     		uxtb	r2, r3
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 44


 1944 008e 334B     		ldr	r3, .L109+20
 1945 0090 1A70     		strb	r2, [r3]
 497:User/Src/OBDII.c ****             if(ecu_fail>10)
 1946              		.loc 1 497 24
 1947 0092 324B     		ldr	r3, .L109+20
 1948 0094 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1949              		.loc 1 497 15
 1950 0096 0A2B     		cmp	r3, #10
 1951 0098 04D9     		bls	.L101
 498:User/Src/OBDII.c ****             {
 499:User/Src/OBDII.c ****                 obd_turn_on=0;
 1952              		.loc 1 499 28
 1953 009a 314B     		ldr	r3, .L109+24
 1954 009c 0022     		movs	r2, #0
 1955 009e 1A70     		strb	r2, [r3]
 500:User/Src/OBDII.c ****                 OBD_ecu_Init();	
 1956              		.loc 1 500 17
 1957 00a0 FFF7FEFF 		bl	OBD_ecu_Init
 1958              	.L101:
 501:User/Src/OBDII.c ****             }
 502:User/Src/OBDII.c ****             return TIME_OUT_ERROR;
 1959              		.loc 1 502 20
 1960 00a4 0323     		movs	r3, #3
 1961 00a6 4BE0     		b	.L108
 1962              	.L100:
 503:User/Src/OBDII.c ****         }
 504:User/Src/OBDII.c ****                     
 505:User/Src/OBDII.c ****         ecu_fail=0;	
 1963              		.loc 1 505 17
 1964 00a8 2C4B     		ldr	r3, .L109+20
 1965 00aa 0022     		movs	r2, #0
 1966 00ac 1A70     		strb	r2, [r3]
 506:User/Src/OBDII.c ****         K_line_RCV(rcv_buf,&rcv_buf_s[0]);			
 1967              		.loc 1 506 9
 1968 00ae 3968     		ldr	r1, [r7]
 1969 00b0 7868     		ldr	r0, [r7, #4]
 1970 00b2 FFF7FEFF 		bl	K_line_RCV
 1971 00b6 3CE0     		b	.L103
 1972              	.L97:
 507:User/Src/OBDII.c **** 	}
 508:User/Src/OBDII.c **** 	else if(flasg_t==CAN_Flag)	
 1973              		.loc 1 508 17
 1974 00b8 244B     		ldr	r3, .L109+4
 1975 00ba 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1976              		.loc 1 508 9
 1977 00bc 012B     		cmp	r3, #1
 1978 00be 38D1     		bne	.L103
 509:User/Src/OBDII.c **** 	{
 510:User/Src/OBDII.c **** 		c_data[0]=send_buf_s;
 1979              		.loc 1 510 12
 1980 00c0 FB7A     		ldrb	r3, [r7, #11]
 1981 00c2 3B74     		strb	r3, [r7, #16]
 511:User/Src/OBDII.c **** 		for(i=1;i<=(1+send_buf_s);i++)
 1982              		.loc 1 511 8
 1983 00c4 0123     		movs	r3, #1
 1984 00c6 FB76     		strb	r3, [r7, #27]
 1985              		.loc 1 511 3
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 45


 1986 00c8 0CE0     		b	.L104
 1987              	.L105:
 512:User/Src/OBDII.c **** 		    c_data[i]=send_buf[i-1];
 1988              		.loc 1 512 25 discriminator 3
 1989 00ca FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 1990 00cc 013B     		subs	r3, r3, #1
 1991 00ce FA68     		ldr	r2, [r7, #12]
 1992 00d0 1A44     		add	r2, r2, r3
 1993              		.loc 1 512 13 discriminator 3
 1994 00d2 FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 1995              		.loc 1 512 25 discriminator 3
 1996 00d4 1278     		ldrb	r2, [r2]	@ zero_extendqisi2
 1997              		.loc 1 512 16 discriminator 3
 1998 00d6 2033     		adds	r3, r3, #32
 1999 00d8 3B44     		add	r3, r3, r7
 2000 00da 03F8102C 		strb	r2, [r3, #-16]
 511:User/Src/OBDII.c **** 		for(i=1;i<=(1+send_buf_s);i++)
 2001              		.loc 1 511 30 discriminator 3
 2002 00de FB7E     		ldrb	r3, [r7, #27]	@ zero_extendqisi2
 2003 00e0 0133     		adds	r3, r3, #1
 2004 00e2 FB76     		strb	r3, [r7, #27]
 2005              	.L104:
 511:User/Src/OBDII.c **** 		for(i=1;i<=(1+send_buf_s);i++)
 2006              		.loc 1 511 12 discriminator 1
 2007 00e4 FA7E     		ldrb	r2, [r7, #27]	@ zero_extendqisi2
 511:User/Src/OBDII.c **** 		for(i=1;i<=(1+send_buf_s);i++)
 2008              		.loc 1 511 16 discriminator 1
 2009 00e6 FB7A     		ldrb	r3, [r7, #11]	@ zero_extendqisi2
 2010 00e8 0133     		adds	r3, r3, #1
 511:User/Src/OBDII.c **** 		for(i=1;i<=(1+send_buf_s);i++)
 2011              		.loc 1 511 3 discriminator 1
 2012 00ea 9A42     		cmp	r2, r3
 2013 00ec EDDD     		ble	.L105
 513:User/Src/OBDII.c **** 		
 514:User/Src/OBDII.c **** 		if(can_send(0x7df , 8,c_data))
 2014              		.loc 1 514 6
 2015 00ee 07F11003 		add	r3, r7, #16
 2016 00f2 1A46     		mov	r2, r3
 2017 00f4 0821     		movs	r1, #8
 2018 00f6 40F2DF70 		movw	r0, #2015
 2019 00fa FFF7FEFF 		bl	can_send
 2020 00fe 0346     		mov	r3, r0
 2021              		.loc 1 514 5
 2022 0100 002B     		cmp	r3, #0
 2023 0102 07D0     		beq	.L106
 515:User/Src/OBDII.c **** 		{
 516:User/Src/OBDII.c **** 			can_rcv(&rcv_buf_s[0],rcv_buf);
 2024              		.loc 1 516 4
 2025 0104 7968     		ldr	r1, [r7, #4]
 2026 0106 3868     		ldr	r0, [r7]
 2027 0108 FFF7FEFF 		bl	can_rcv
 517:User/Src/OBDII.c **** 		    ecu_fail=0;
 2028              		.loc 1 517 15
 2029 010c 134B     		ldr	r3, .L109+20
 2030 010e 0022     		movs	r2, #0
 2031 0110 1A70     		strb	r2, [r3]
 2032 0112 0EE0     		b	.L103
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 46


 2033              	.L106:
 518:User/Src/OBDII.c **** 		}else{
 519:User/Src/OBDII.c **** 			ecu_fail++;
 2034              		.loc 1 519 12
 2035 0114 114B     		ldr	r3, .L109+20
 2036 0116 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2037 0118 0133     		adds	r3, r3, #1
 2038 011a DAB2     		uxtb	r2, r3
 2039 011c 0F4B     		ldr	r3, .L109+20
 2040 011e 1A70     		strb	r2, [r3]
 520:User/Src/OBDII.c **** 			if(ecu_fail>15)
 2041              		.loc 1 520 15
 2042 0120 0E4B     		ldr	r3, .L109+20
 2043 0122 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2044              		.loc 1 520 6
 2045 0124 0F2B     		cmp	r3, #15
 2046 0126 04D9     		bls	.L103
 521:User/Src/OBDII.c **** 			{
 522:User/Src/OBDII.c **** 			    obd_turn_on=0;
 2047              		.loc 1 522 19
 2048 0128 0D4B     		ldr	r3, .L109+24
 2049 012a 0022     		movs	r2, #0
 2050 012c 1A70     		strb	r2, [r3]
 523:User/Src/OBDII.c **** 			    OBD_ecu_Init();	
 2051              		.loc 1 523 8
 2052 012e FFF7FEFF 		bl	OBD_ecu_Init
 2053              	.L103:
 524:User/Src/OBDII.c **** 			}
 525:User/Src/OBDII.c **** 		}
 526:User/Src/OBDII.c **** 	}
 527:User/Src/OBDII.c **** 	
 528:User/Src/OBDII.c **** 	if(rcv_buf[0]==0X7F)
 2054              		.loc 1 528 12
 2055 0132 7B68     		ldr	r3, [r7, #4]
 2056 0134 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2057              		.loc 1 528 4
 2058 0136 7F2B     		cmp	r3, #127
 2059 0138 01D1     		bne	.L107
 529:User/Src/OBDII.c **** 	    return RSP_ERROR;
 2060              		.loc 1 529 13
 2061 013a 0023     		movs	r3, #0
 2062 013c 00E0     		b	.L108
 2063              	.L107:
 530:User/Src/OBDII.c **** 	
 531:User/Src/OBDII.c **** 	return TURE_RSP;	
 2064              		.loc 1 531 9
 2065 013e 0123     		movs	r3, #1
 2066              	.L108:
 532:User/Src/OBDII.c **** }
 2067              		.loc 1 532 1 discriminator 1
 2068 0140 1846     		mov	r0, r3
 2069 0142 2437     		adds	r7, r7, #36
 2070              	.LCFI43:
 2071              		.cfi_def_cfa_offset 12
 2072 0144 BD46     		mov	sp, r7
 2073              	.LCFI44:
 2074              		.cfi_def_cfa_register 13
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 47


 2075              		@ sp needed
 2076 0146 90BD     		pop	{r4, r7, pc}
 2077              	.L110:
 2078              		.align	2
 2079              	.L109:
 2080 0148 10000000 		.word	.LC2
 2081 014c 00000000 		.word	flasg_t
 2082 0150 00000000 		.word	obd_count
 2083 0154 FEFF2F00 		.word	3145726
 2084 0158 FFFF2F00 		.word	3145727
 2085 015c 00000000 		.word	ecu_fail.0
 2086 0160 00000000 		.word	obd_turn_on
 2087              		.cfi_endproc
 2088              	.LFE143:
 2090              		.section	.text.OBD_Serial_Init,"ax",%progbits
 2091              		.align	1
 2092              		.global	OBD_Serial_Init
 2093              		.syntax unified
 2094              		.thumb
 2095              		.thumb_func
 2097              	OBD_Serial_Init:
 2098              	.LFB144:
 533:User/Src/OBDII.c **** 
 534:User/Src/OBDII.c **** 
 535:User/Src/OBDII.c **** /*******************************************************************************
 536:User/Src/OBDII.c **** * Function Name  : OBD_Serial_Init
 537:User/Src/OBDII.c **** * Description    : micro serial init for ISO 9141-2
 538:User/Src/OBDII.c **** * Input          : None
 539:User/Src/OBDII.c **** * Output         : None
 540:User/Src/OBDII.c **** * Return         : None
 541:User/Src/OBDII.c **** *******************************************************************************/	
 542:User/Src/OBDII.c **** void OBD_Serial_Init(void)
 543:User/Src/OBDII.c **** {
 2099              		.loc 1 543 1
 2100              		.cfi_startproc
 2101              		@ args = 0, pretend = 0, frame = 32
 2102              		@ frame_needed = 1, uses_anonymous_args = 0
 2103 0000 80B5     		push	{r7, lr}
 2104              	.LCFI45:
 2105              		.cfi_def_cfa_offset 8
 2106              		.cfi_offset 7, -8
 2107              		.cfi_offset 14, -4
 2108 0002 88B0     		sub	sp, sp, #32
 2109              	.LCFI46:
 2110              		.cfi_def_cfa_offset 40
 2111 0004 00AF     		add	r7, sp, #0
 2112              	.LCFI47:
 2113              		.cfi_def_cfa_register 7
 544:User/Src/OBDII.c ****     NVIC_InitTypeDef NVIC_InitStructure;	
 545:User/Src/OBDII.c ****     GPIO_InitTypeDef GPIO_InitStructure;
 546:User/Src/OBDII.c ****     USART_InitTypeDef USART_InitStructure; 
 547:User/Src/OBDII.c **** 
 548:User/Src/OBDII.c ****     RCC_APB2PeriphClockCmd(RCC_AHB1Periph_GPIOA | RCC_APB2Periph_USART1, ENABLE);
 2114              		.loc 1 548 5
 2115 0006 0121     		movs	r1, #1
 2116 0008 1120     		movs	r0, #17
 2117 000a FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 48


 549:User/Src/OBDII.c ****     /*
 550:User/Src/OBDII.c ****     *  USART1_TX -> PA9 , USART1_RX ->	PA10
 551:User/Src/OBDII.c ****     */		
 552:User/Src/OBDII.c **** 
 553:User/Src/OBDII.c ****     RCC_APB2PeriphClockCmd( RCC_AHB1Periph_GPIOC, ENABLE);
 2118              		.loc 1 553 5
 2119 000e 0121     		movs	r1, #1
 2120 0010 0420     		movs	r0, #4
 2121 0012 FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 554:User/Src/OBDII.c ****     GPIO_SetBits(GPIOC,GPIO_Pin_13);
 2122              		.loc 1 554 5
 2123 0016 4FF40051 		mov	r1, #8192
 2124 001a 3C48     		ldr	r0, .L112
 2125 001c FFF7FEFF 		bl	GPIO_SetBits
 555:User/Src/OBDII.c **** 
 556:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Pin = GPIO_Pin_13;	         
 2126              		.loc 1 556 33
 2127 0020 4FF40053 		mov	r3, #8192
 2128 0024 7B61     		str	r3, [r7, #20]
 557:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
 2129              		.loc 1 557 34
 2130 0026 0123     		movs	r3, #1
 2131 0028 3B76     		strb	r3, [r7, #24]
 558:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 2132              		.loc 1 558 35
 2133 002a 0023     		movs	r3, #0
 2134 002c BB76     		strb	r3, [r7, #26]
 559:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 2135              		.loc 1 559 34
 2136 002e 0023     		movs	r3, #0
 2137 0030 FB76     		strb	r3, [r7, #27]
 560:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 2138              		.loc 1 560 35
 2139 0032 0223     		movs	r3, #2
 2140 0034 7B76     		strb	r3, [r7, #25]
 561:User/Src/OBDII.c **** 
 562:User/Src/OBDII.c ****     GPIO_Init(GPIOC, &GPIO_InitStructure);	
 2141              		.loc 1 562 5
 2142 0036 07F11403 		add	r3, r7, #20
 2143 003a 1946     		mov	r1, r3
 2144 003c 3348     		ldr	r0, .L112
 2145 003e FFF7FEFF 		bl	GPIO_Init
 563:User/Src/OBDII.c ****         
 564:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;	         
 2146              		.loc 1 564 33
 2147 0042 4FF40073 		mov	r3, #512
 2148 0046 7B61     		str	r3, [r7, #20]
 565:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 2149              		.loc 1 565 34
 2150 0048 0223     		movs	r3, #2
 2151 004a 3B76     		strb	r3, [r7, #24]
 566:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 2152              		.loc 1 566 35
 2153 004c 0023     		movs	r3, #0
 2154 004e BB76     		strb	r3, [r7, #26]
 567:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 2155              		.loc 1 567 34
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 49


 2156 0050 0023     		movs	r3, #0
 2157 0052 FB76     		strb	r3, [r7, #27]
 568:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 2158              		.loc 1 568 35
 2159 0054 0223     		movs	r3, #2
 2160 0056 7B76     		strb	r3, [r7, #25]
 569:User/Src/OBDII.c **** 
 570:User/Src/OBDII.c ****     GPIO_PinAFConfig(GPIOA, GPIO_PinSource9, GPIO_AF_USART1);
 2161              		.loc 1 570 5
 2162 0058 0722     		movs	r2, #7
 2163 005a 0921     		movs	r1, #9
 2164 005c 2C48     		ldr	r0, .L112+4
 2165 005e FFF7FEFF 		bl	GPIO_PinAFConfig
 571:User/Src/OBDII.c ****     GPIO_PinAFConfig(GPIOA, GPIO_PinSource10, GPIO_AF_USART1);
 2166              		.loc 1 571 5
 2167 0062 0722     		movs	r2, #7
 2168 0064 0A21     		movs	r1, #10
 2169 0066 2A48     		ldr	r0, .L112+4
 2170 0068 FFF7FEFF 		bl	GPIO_PinAFConfig
 572:User/Src/OBDII.c **** 
 573:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);		   
 2171              		.loc 1 573 5
 2172 006c 07F11403 		add	r3, r7, #20
 2173 0070 1946     		mov	r1, r3
 2174 0072 2748     		ldr	r0, .L112+4
 2175 0074 FFF7FEFF 		bl	GPIO_Init
 574:User/Src/OBDII.c **** 
 575:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Pin = GPIO_Pin_10;	        
 2176              		.loc 1 575 33
 2177 0078 4FF48063 		mov	r3, #1024
 2178 007c 7B61     		str	r3, [r7, #20]
 576:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);
 2179              		.loc 1 576 5
 2180 007e 07F11403 		add	r3, r7, #20
 2181 0082 1946     		mov	r1, r3
 2182 0084 2248     		ldr	r0, .L112+4
 2183 0086 FFF7FEFF 		bl	GPIO_Init
 577:User/Src/OBDII.c **** 
 578:User/Src/OBDII.c ****     USART_InitStructure.USART_BaudRate = 10400;
 2184              		.loc 1 578 40
 2185 008a 42F6A003 		movw	r3, #10400
 2186 008e 7B60     		str	r3, [r7, #4]
 579:User/Src/OBDII.c ****     USART_InitStructure.USART_WordLength = USART_WordLength_8b;
 2187              		.loc 1 579 42
 2188 0090 0023     		movs	r3, #0
 2189 0092 3B81     		strh	r3, [r7, #8]	@ movhi
 580:User/Src/OBDII.c ****     USART_InitStructure.USART_StopBits = USART_StopBits_1;
 2190              		.loc 1 580 40
 2191 0094 0023     		movs	r3, #0
 2192 0096 7B81     		strh	r3, [r7, #10]	@ movhi
 581:User/Src/OBDII.c ****     USART_InitStructure.USART_Parity = USART_Parity_No;
 2193              		.loc 1 581 38
 2194 0098 0023     		movs	r3, #0
 2195 009a BB81     		strh	r3, [r7, #12]	@ movhi
 582:User/Src/OBDII.c ****     USART_InitStructure.USART_HardwareFlowControl = USART_HardwareFlowControl_None;
 2196              		.loc 1 582 51
 2197 009c 0023     		movs	r3, #0
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 50


 2198 009e 3B82     		strh	r3, [r7, #16]	@ movhi
 583:User/Src/OBDII.c ****     USART_InitStructure.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;
 2199              		.loc 1 583 36
 2200 00a0 0C23     		movs	r3, #12
 2201 00a2 FB81     		strh	r3, [r7, #14]	@ movhi
 584:User/Src/OBDII.c **** 
 585:User/Src/OBDII.c ****     USART_Init(USART1, &USART_InitStructure); 
 2202              		.loc 1 585 5
 2203 00a4 3B1D     		adds	r3, r7, #4
 2204 00a6 1946     		mov	r1, r3
 2205 00a8 1A48     		ldr	r0, .L112+8
 2206 00aa FFF7FEFF 		bl	USART_Init
 586:User/Src/OBDII.c ****     USART_ITConfig(USART1, USART_IT_RXNE, ENABLE);
 2207              		.loc 1 586 5
 2208 00ae 0122     		movs	r2, #1
 2209 00b0 40F22551 		movw	r1, #1317
 2210 00b4 1748     		ldr	r0, .L112+8
 2211 00b6 FFF7FEFF 		bl	USART_ITConfig
 587:User/Src/OBDII.c ****     USART_ITConfig(USART1, USART_IT_TXE,DISABLE);
 2212              		.loc 1 587 5
 2213 00ba 0022     		movs	r2, #0
 2214 00bc 40F22771 		movw	r1, #1831
 2215 00c0 1448     		ldr	r0, .L112+8
 2216 00c2 FFF7FEFF 		bl	USART_ITConfig
 588:User/Src/OBDII.c ****     USART_ClearFlag(USART1,USART_FLAG_TC);
 2217              		.loc 1 588 5
 2218 00c6 4021     		movs	r1, #64
 2219 00c8 1248     		ldr	r0, .L112+8
 2220 00ca FFF7FEFF 		bl	USART_ClearFlag
 589:User/Src/OBDII.c ****     USART_Cmd(USART1, ENABLE);
 2221              		.loc 1 589 5
 2222 00ce 0121     		movs	r1, #1
 2223 00d0 1048     		ldr	r0, .L112+8
 2224 00d2 FFF7FEFF 		bl	USART_Cmd
 590:User/Src/OBDII.c **** 
 591:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannel = USART1_IRQn;
 2225              		.loc 1 591 40
 2226 00d6 2523     		movs	r3, #37
 2227 00d8 3B77     		strb	r3, [r7, #28]
 592:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 2228              		.loc 1 592 58
 2229 00da 0023     		movs	r3, #0
 2230 00dc 7B77     		strb	r3, [r7, #29]
 593:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 2231              		.loc 1 593 43
 2232 00de 0123     		movs	r3, #1
 2233 00e0 FB77     		strb	r3, [r7, #31]
 594:User/Src/OBDII.c ****     NVIC_Init(&NVIC_InitStructure);
 2234              		.loc 1 594 5
 2235 00e2 07F11C03 		add	r3, r7, #28
 2236 00e6 1846     		mov	r0, r3
 2237 00e8 FFF7FEFF 		bl	NVIC_Init
 595:User/Src/OBDII.c ****     USART_ClearFlag(USART1,USART_FLAG_RXNE);
 2238              		.loc 1 595 5
 2239 00ec 2021     		movs	r1, #32
 2240 00ee 0948     		ldr	r0, .L112+8
 2241 00f0 FFF7FEFF 		bl	USART_ClearFlag
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 51


 596:User/Src/OBDII.c ****     USART_ClearFlag(USART1,USART_FLAG_TC);
 2242              		.loc 1 596 5
 2243 00f4 4021     		movs	r1, #64
 2244 00f6 0748     		ldr	r0, .L112+8
 2245 00f8 FFF7FEFF 		bl	USART_ClearFlag
 597:User/Src/OBDII.c ****     USART_Cmd(USART1, ENABLE);		
 2246              		.loc 1 597 5
 2247 00fc 0121     		movs	r1, #1
 2248 00fe 0548     		ldr	r0, .L112+8
 2249 0100 FFF7FEFF 		bl	USART_Cmd
 598:User/Src/OBDII.c **** }
 2250              		.loc 1 598 1
 2251 0104 00BF     		nop
 2252 0106 2037     		adds	r7, r7, #32
 2253              	.LCFI48:
 2254              		.cfi_def_cfa_offset 8
 2255 0108 BD46     		mov	sp, r7
 2256              	.LCFI49:
 2257              		.cfi_def_cfa_register 13
 2258              		@ sp needed
 2259 010a 80BD     		pop	{r7, pc}
 2260              	.L113:
 2261              		.align	2
 2262              	.L112:
 2263 010c 00080240 		.word	1073874944
 2264 0110 00000240 		.word	1073872896
 2265 0114 00100140 		.word	1073811456
 2266              		.cfi_endproc
 2267              	.LFE144:
 2269              		.section	.text.can_Configuration,"ax",%progbits
 2270              		.align	1
 2271              		.global	can_Configuration
 2272              		.syntax unified
 2273              		.thumb
 2274              		.thumb_func
 2276              	can_Configuration:
 2277              	.LFB145:
 599:User/Src/OBDII.c **** 
 600:User/Src/OBDII.c **** 
 601:User/Src/OBDII.c **** /*******************************************************************************
 602:User/Src/OBDII.c **** * Function Name  : can_Configuration
 603:User/Src/OBDII.c **** * Description    : micro serial init for ISO 15765
 604:User/Src/OBDII.c **** * Input          : None
 605:User/Src/OBDII.c **** * Output         : None
 606:User/Src/OBDII.c **** * Return         : None
 607:User/Src/OBDII.c **** *******************************************************************************/	
 608:User/Src/OBDII.c **** 	
 609:User/Src/OBDII.c **** void can_Configuration(void)
 610:User/Src/OBDII.c **** {
 2278              		.loc 1 610 1
 2279              		.cfi_startproc
 2280              		@ args = 0, pretend = 0, frame = 40
 2281              		@ frame_needed = 1, uses_anonymous_args = 0
 2282 0000 80B5     		push	{r7, lr}
 2283              	.LCFI50:
 2284              		.cfi_def_cfa_offset 8
 2285              		.cfi_offset 7, -8
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 52


 2286              		.cfi_offset 14, -4
 2287 0002 8AB0     		sub	sp, sp, #40
 2288              	.LCFI51:
 2289              		.cfi_def_cfa_offset 48
 2290 0004 00AF     		add	r7, sp, #0
 2291              	.LCFI52:
 2292              		.cfi_def_cfa_register 7
 611:User/Src/OBDII.c ****     CAN_InitTypeDef         CAN_InitStructure;
 612:User/Src/OBDII.c ****     CAN_FilterInitTypeDef   CAN_FilterInitStructure;
 613:User/Src/OBDII.c ****     GPIO_InitTypeDef        GPIO_InitStructure;
 614:User/Src/OBDII.c ****     NVIC_InitTypeDef        NVIC_InitStructure;
 615:User/Src/OBDII.c **** 
 616:User/Src/OBDII.c ****     RCC_APB2PeriphClockCmd(RCC_AHB1Periph_GPIOB, ENABLE); 
 2293              		.loc 1 616 5
 2294 0006 0121     		movs	r1, #1
 2295 0008 0220     		movs	r0, #2
 2296 000a FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 617:User/Src/OBDII.c **** 
 618:User/Src/OBDII.c ****     /* Configure CAN pin: TX */
 619:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8;	         
 2297              		.loc 1 619 33
 2298 000e 4FF48073 		mov	r3, #256
 2299 0012 7B60     		str	r3, [r7, #4]
 620:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 2300              		.loc 1 620 34
 2301 0014 0223     		movs	r3, #2
 2302 0016 3B72     		strb	r3, [r7, #8]
 621:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 2303              		.loc 1 621 35
 2304 0018 0023     		movs	r3, #0
 2305 001a BB72     		strb	r3, [r7, #10]
 622:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 2306              		.loc 1 622 34
 2307 001c 0023     		movs	r3, #0
 2308 001e FB72     		strb	r3, [r7, #11]
 623:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 2309              		.loc 1 623 35
 2310 0020 0223     		movs	r3, #2
 2311 0022 7B72     		strb	r3, [r7, #9]
 624:User/Src/OBDII.c **** 
 625:User/Src/OBDII.c ****     GPIO_PinAFConfig(GPIOB, GPIO_PinSource8, GPIO_AF_CAN1);
 2312              		.loc 1 625 5
 2313 0024 0922     		movs	r2, #9
 2314 0026 0821     		movs	r1, #8
 2315 0028 3C48     		ldr	r0, .L115
 2316 002a FFF7FEFF 		bl	GPIO_PinAFConfig
 626:User/Src/OBDII.c **** 	GPIO_PinAFConfig(GPIOB, GPIO_PinSource9, GPIO_AF_CAN1);
 2317              		.loc 1 626 2
 2318 002e 0922     		movs	r2, #9
 2319 0030 0921     		movs	r1, #9
 2320 0032 3A48     		ldr	r0, .L115
 2321 0034 FFF7FEFF 		bl	GPIO_PinAFConfig
 627:User/Src/OBDII.c **** 
 628:User/Src/OBDII.c ****     GPIO_Init(GPIOB, &GPIO_InitStructure);
 2322              		.loc 1 628 5
 2323 0038 3B1D     		adds	r3, r7, #4
 2324 003a 1946     		mov	r1, r3
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 53


 2325 003c 3748     		ldr	r0, .L115
 2326 003e FFF7FEFF 		bl	GPIO_Init
 629:User/Src/OBDII.c **** 
 630:User/Src/OBDII.c ****     /* Configure CAN pin: TX */
 631:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;
 2327              		.loc 1 631 33
 2328 0042 4FF40073 		mov	r3, #512
 2329 0046 7B60     		str	r3, [r7, #4]
 632:User/Src/OBDII.c ****     
 633:User/Src/OBDII.c ****     GPIO_Init(GPIOB, &GPIO_InitStructure);
 2330              		.loc 1 633 5
 2331 0048 3B1D     		adds	r3, r7, #4
 2332 004a 1946     		mov	r1, r3
 2333 004c 3348     		ldr	r0, .L115
 2334 004e FFF7FEFF 		bl	GPIO_Init
 634:User/Src/OBDII.c **** 
 635:User/Src/OBDII.c ****     RCC_APB1PeriphClockCmd(RCC_APB1Periph_CAN1, ENABLE);		
 2335              		.loc 1 635 5
 2336 0052 0121     		movs	r1, #1
 2337 0054 4FF00070 		mov	r0, #33554432
 2338 0058 FFF7FEFF 		bl	RCC_APB1PeriphClockCmd
 636:User/Src/OBDII.c ****     /* CAN register init */
 637:User/Src/OBDII.c ****     CAN_DeInit(CAN1);
 2339              		.loc 1 637 5
 2340 005c 3048     		ldr	r0, .L115+4
 2341 005e FFF7FEFF 		bl	CAN_DeInit
 638:User/Src/OBDII.c ****     CAN_StructInit(&CAN_InitStructure);
 2342              		.loc 1 638 5
 2343 0062 07F11C03 		add	r3, r7, #28
 2344 0066 1846     		mov	r0, r3
 2345 0068 FFF7FEFF 		bl	CAN_StructInit
 639:User/Src/OBDII.c **** 
 640:User/Src/OBDII.c ****     /* CAN cell init */
 641:User/Src/OBDII.c ****     CAN_StructInit(&CAN_InitStructure);
 2346              		.loc 1 641 5
 2347 006c 07F11C03 		add	r3, r7, #28
 2348 0070 1846     		mov	r0, r3
 2349 0072 FFF7FEFF 		bl	CAN_StructInit
 642:User/Src/OBDII.c **** 
 643:User/Src/OBDII.c ****     /* CAN1 and CAN2  cell init */
 644:User/Src/OBDII.c ****     CAN_InitStructure.CAN_TTCM = DISABLE;
 2350              		.loc 1 644 32
 2351 0076 0023     		movs	r3, #0
 2352 0078 87F82230 		strb	r3, [r7, #34]
 645:User/Src/OBDII.c ****     CAN_InitStructure.CAN_ABOM = DISABLE;
 2353              		.loc 1 645 32
 2354 007c 0023     		movs	r3, #0
 2355 007e 87F82330 		strb	r3, [r7, #35]
 646:User/Src/OBDII.c ****     CAN_InitStructure.CAN_AWUM = DISABLE;
 2356              		.loc 1 646 32
 2357 0082 0023     		movs	r3, #0
 2358 0084 87F82430 		strb	r3, [r7, #36]
 647:User/Src/OBDII.c ****     CAN_InitStructure.CAN_NART = DISABLE;
 2359              		.loc 1 647 32
 2360 0088 0023     		movs	r3, #0
 2361 008a 87F82530 		strb	r3, [r7, #37]
 648:User/Src/OBDII.c ****     CAN_InitStructure.CAN_RFLM = DISABLE;
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 54


 2362              		.loc 1 648 32
 2363 008e 0023     		movs	r3, #0
 2364 0090 87F82630 		strb	r3, [r7, #38]
 649:User/Src/OBDII.c ****     CAN_InitStructure.CAN_TXFP = ENABLE;
 2365              		.loc 1 649 32
 2366 0094 0123     		movs	r3, #1
 2367 0096 87F82730 		strb	r3, [r7, #39]
 650:User/Src/OBDII.c ****     CAN_InitStructure.CAN_Mode = CAN_Mode_Normal;
 2368              		.loc 1 650 32
 2369 009a 0023     		movs	r3, #0
 2370 009c BB77     		strb	r3, [r7, #30]
 651:User/Src/OBDII.c **** 
 652:User/Src/OBDII.c **** 
 653:User/Src/OBDII.c ****     CAN_InitStructure.CAN_SJW = CAN_SJW_1tq;  
 2371              		.loc 1 653 31
 2372 009e 0023     		movs	r3, #0
 2373 00a0 FB77     		strb	r3, [r7, #31]
 654:User/Src/OBDII.c ****     CAN_InitStructure.CAN_BS1 = CAN_BS1_12tq;
 2374              		.loc 1 654 31
 2375 00a2 0B23     		movs	r3, #11
 2376 00a4 87F82030 		strb	r3, [r7, #32]
 655:User/Src/OBDII.c ****     CAN_InitStructure.CAN_BS2 = CAN_BS2_8tq;
 2377              		.loc 1 655 31
 2378 00a8 0723     		movs	r3, #7
 2379 00aa 87F82130 		strb	r3, [r7, #33]
 656:User/Src/OBDII.c ****     CAN_InitStructure.CAN_Prescaler = 4;
 2380              		.loc 1 656 37
 2381 00ae 0423     		movs	r3, #4
 2382 00b0 BB83     		strh	r3, [r7, #28]	@ movhi
 657:User/Src/OBDII.c ****     //  CAN_InitStructure.CAN_Prescaler =16;
 658:User/Src/OBDII.c ****     CAN_Init(CAN1, &CAN_InitStructure);
 2383              		.loc 1 658 5
 2384 00b2 07F11C03 		add	r3, r7, #28
 2385 00b6 1946     		mov	r1, r3
 2386 00b8 1948     		ldr	r0, .L115+4
 2387 00ba FFF7FEFF 		bl	CAN_Init
 659:User/Src/OBDII.c ****     /* CAN filter init */
 660:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterNumber = 1;
 2388              		.loc 1 660 46
 2389 00be 0123     		movs	r3, #1
 2390 00c0 BB75     		strb	r3, [r7, #22]
 661:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterMode = CAN_FilterMode_IdMask;
 2391              		.loc 1 661 44
 2392 00c2 0023     		movs	r3, #0
 2393 00c4 FB75     		strb	r3, [r7, #23]
 662:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterScale = CAN_FilterScale_32bit;
 2394              		.loc 1 662 45
 2395 00c6 0123     		movs	r3, #1
 2396 00c8 3B76     		strb	r3, [r7, #24]
 663:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterIdHigh = 0xE000;
 2397              		.loc 1 663 46
 2398 00ca 4FF46043 		mov	r3, #57344
 2399 00ce BB81     		strh	r3, [r7, #12]	@ movhi
 664:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterIdLow = 0x0000;
 2400              		.loc 1 664 45
 2401 00d0 0023     		movs	r3, #0
 2402 00d2 FB81     		strh	r3, [r7, #14]	@ movhi
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 55


 665:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterMaskIdHigh = 0xE000;
 2403              		.loc 1 665 50
 2404 00d4 4FF46043 		mov	r3, #57344
 2405 00d8 3B82     		strh	r3, [r7, #16]	@ movhi
 666:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterMaskIdLow = 0x0000;
 2406              		.loc 1 666 49
 2407 00da 0023     		movs	r3, #0
 2408 00dc 7B82     		strh	r3, [r7, #18]	@ movhi
 667:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterFIFOAssignment = 0;
 2409              		.loc 1 667 54
 2410 00de 0023     		movs	r3, #0
 2411 00e0 BB82     		strh	r3, [r7, #20]	@ movhi
 668:User/Src/OBDII.c ****     CAN_FilterInitStructure.CAN_FilterActivation = ENABLE;
 2412              		.loc 1 668 50
 2413 00e2 0123     		movs	r3, #1
 2414 00e4 7B76     		strb	r3, [r7, #25]
 669:User/Src/OBDII.c ****     CAN_FilterInit(&CAN_FilterInitStructure);
 2415              		.loc 1 669 5
 2416 00e6 07F10C03 		add	r3, r7, #12
 2417 00ea 1846     		mov	r0, r3
 2418 00ec FFF7FEFF 		bl	CAN_FilterInit
 670:User/Src/OBDII.c **** 
 671:User/Src/OBDII.c **** 
 672:User/Src/OBDII.c **** 
 673:User/Src/OBDII.c ****     /* Enable CAN1 RX0 interrupt IRQ channel */
 674:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannel = CAN1_RX0_IRQn;
 2419              		.loc 1 674 40
 2420 00f0 1423     		movs	r3, #20
 2421 00f2 3B70     		strb	r3, [r7]
 675:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 2422              		.loc 1 675 58
 2423 00f4 0023     		movs	r3, #0
 2424 00f6 7B70     		strb	r3, [r7, #1]
 676:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 2425              		.loc 1 676 51
 2426 00f8 0023     		movs	r3, #0
 2427 00fa BB70     		strb	r3, [r7, #2]
 677:User/Src/OBDII.c ****     NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 2428              		.loc 1 677 43
 2429 00fc 0123     		movs	r3, #1
 2430 00fe FB70     		strb	r3, [r7, #3]
 678:User/Src/OBDII.c ****     NVIC_Init(&NVIC_InitStructure);
 2431              		.loc 1 678 5
 2432 0100 3B46     		mov	r3, r7
 2433 0102 1846     		mov	r0, r3
 2434 0104 FFF7FEFF 		bl	NVIC_Init
 679:User/Src/OBDII.c ****     CAN_ITConfig(CAN1,CAN_IT_FMP0, ENABLE);
 2435              		.loc 1 679 5
 2436 0108 0122     		movs	r2, #1
 2437 010a 0221     		movs	r1, #2
 2438 010c 0448     		ldr	r0, .L115+4
 2439 010e FFF7FEFF 		bl	CAN_ITConfig
 680:User/Src/OBDII.c **** }
 2440              		.loc 1 680 1
 2441 0112 00BF     		nop
 2442 0114 2837     		adds	r7, r7, #40
 2443              	.LCFI53:
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 56


 2444              		.cfi_def_cfa_offset 8
 2445 0116 BD46     		mov	sp, r7
 2446              	.LCFI54:
 2447              		.cfi_def_cfa_register 13
 2448              		@ sp needed
 2449 0118 80BD     		pop	{r7, pc}
 2450              	.L116:
 2451 011a 00BF     		.align	2
 2452              	.L115:
 2453 011c 00040240 		.word	1073873920
 2454 0120 00640040 		.word	1073767424
 2455              		.cfi_endproc
 2456              	.LFE145:
 2458              		.section	.text.bus_off,"ax",%progbits
 2459              		.align	1
 2460              		.global	bus_off
 2461              		.syntax unified
 2462              		.thumb
 2463              		.thumb_func
 2465              	bus_off:
 2466              	.LFB146:
 681:User/Src/OBDII.c **** 
 682:User/Src/OBDII.c **** /*******************************************************************************
 683:User/Src/OBDII.c **** * Function Name  : bus_off
 684:User/Src/OBDII.c **** * Description    : sleep bus
 685:User/Src/OBDII.c **** * Input          : None
 686:User/Src/OBDII.c **** * Output         : None
 687:User/Src/OBDII.c **** * Return         : None
 688:User/Src/OBDII.c **** *******************************************************************************/	
 689:User/Src/OBDII.c **** void bus_off(void)
 690:User/Src/OBDII.c **** { 
 2467              		.loc 1 690 1
 2468              		.cfi_startproc
 2469              		@ args = 0, pretend = 0, frame = 16
 2470              		@ frame_needed = 1, uses_anonymous_args = 0
 2471 0000 80B5     		push	{r7, lr}
 2472              	.LCFI55:
 2473              		.cfi_def_cfa_offset 8
 2474              		.cfi_offset 7, -8
 2475              		.cfi_offset 14, -4
 2476 0002 84B0     		sub	sp, sp, #16
 2477              	.LCFI56:
 2478              		.cfi_def_cfa_offset 24
 2479 0004 00AF     		add	r7, sp, #0
 2480              	.LCFI57:
 2481              		.cfi_def_cfa_register 7
 691:User/Src/OBDII.c ****     GPIO_InitTypeDef GPIO_InitStructure;	
 692:User/Src/OBDII.c ****     uint16_t temp = 0;
 2482              		.loc 1 692 14
 2483 0006 0023     		movs	r3, #0
 2484 0008 FB81     		strh	r3, [r7, #14]	@ movhi
 693:User/Src/OBDII.c **** 
 694:User/Src/OBDII.c ****     RCC_APB2PeriphClockCmd(RCC_AHB1Periph_GPIOA, ENABLE);
 2485              		.loc 1 694 5
 2486 000a 0121     		movs	r1, #1
 2487 000c 0120     		movs	r0, #1
 2488 000e FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 57


 695:User/Src/OBDII.c **** 
 696:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Pin = GPIO_Pin_9;	         
 2489              		.loc 1 696 33
 2490 0012 4FF40073 		mov	r3, #512
 2491 0016 7B60     		str	r3, [r7, #4]
 697:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;
 2492              		.loc 1 697 34
 2493 0018 0123     		movs	r3, #1
 2494 001a 3B72     		strb	r3, [r7, #8]
 698:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 2495              		.loc 1 698 35
 2496 001c 0023     		movs	r3, #0
 2497 001e BB72     		strb	r3, [r7, #10]
 699:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL; 
 2498              		.loc 1 699 34
 2499 0020 0023     		movs	r3, #0
 2500 0022 FB72     		strb	r3, [r7, #11]
 700:User/Src/OBDII.c ****     GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
 2501              		.loc 1 700 35
 2502 0024 0223     		movs	r3, #2
 2503 0026 7B72     		strb	r3, [r7, #9]
 701:User/Src/OBDII.c ****     GPIO_Init(GPIOA, &GPIO_InitStructure);		   
 2504              		.loc 1 701 5
 2505 0028 3B1D     		adds	r3, r7, #4
 2506 002a 1946     		mov	r1, r3
 2507 002c 0848     		ldr	r0, .L118
 2508 002e FFF7FEFF 		bl	GPIO_Init
 702:User/Src/OBDII.c **** 
 703:User/Src/OBDII.c ****     GPIO_SetBits(GPIOA,GPIO_Pin_9);
 2509              		.loc 1 703 5
 2510 0032 4FF40071 		mov	r1, #512
 2511 0036 0648     		ldr	r0, .L118
 2512 0038 FFF7FEFF 		bl	GPIO_SetBits
 704:User/Src/OBDII.c ****     GPIO_ResetBits(GPIOC,GPIO_Pin_13);	
 2513              		.loc 1 704 5
 2514 003c 4FF40051 		mov	r1, #8192
 2515 0040 0448     		ldr	r0, .L118+4
 2516 0042 FFF7FEFF 		bl	GPIO_ResetBits
 705:User/Src/OBDII.c **** }
 2517              		.loc 1 705 1
 2518 0046 00BF     		nop
 2519 0048 1037     		adds	r7, r7, #16
 2520              	.LCFI58:
 2521              		.cfi_def_cfa_offset 8
 2522 004a BD46     		mov	sp, r7
 2523              	.LCFI59:
 2524              		.cfi_def_cfa_register 13
 2525              		@ sp needed
 2526 004c 80BD     		pop	{r7, pc}
 2527              	.L119:
 2528 004e 00BF     		.align	2
 2529              	.L118:
 2530 0050 00000240 		.word	1073872896
 2531 0054 00080240 		.word	1073874944
 2532              		.cfi_endproc
 2533              	.LFE146:
 2535              		.section	.bss.ecu_fail.1,"aw",%nobits
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 58


 2538              	ecu_fail.1:
 2539 0000 00       		.space	1
 2540              		.section	.bss.ecu_fail.0,"aw",%nobits
 2543              	ecu_fail.0:
 2544 0000 00       		.space	1
 2545              		.text
 2546              	.Letext0:
 2547              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 2548              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 2549              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 2550              		.file 5 "Drivers/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_gpio.h"
 2551              		.file 6 "Drivers/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_tim.h"
 2552              		.file 7 "Drivers/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_usart.h"
 2553              		.file 8 "Drivers/STM32F4xx_StdPeriph_Driver/inc/misc.h"
 2554              		.file 9 "Drivers/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_can.h"
 2555              		.file 10 "User/Inc/OBDII.h"
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 59


DEFINED SYMBOLS
                            *ABS*:00000000 OBDII.c
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:24     .bss.c_dt:00000000 c_dt
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:21     .bss.c_dt:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:30     .bss.c_rcv_flag:00000000 c_rcv_flag
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:31     .bss.c_rcv_flag:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:36     .bss.flasg_t:00000000 flasg_t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:37     .bss.flasg_t:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:43     .bss.init_obd:00000000 init_obd
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:40     .bss.init_obd:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:49     .bss.obd_turn_on:00000000 obd_turn_on
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:50     .bss.obd_turn_on:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:56     .bss.obd_data:00000000 obd_data
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:53     .bss.obd_data:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:62     .bss.obd_count:00000000 obd_count
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:63     .bss.obd_count:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:68     .bss.OBD_RCV_T:00000000 OBD_RCV_T
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:69     .bss.OBD_RCV_T:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:71     .text.can_send:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:77     .text.can_send:00000000 can_send
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:216    .text.can_send:000000b0 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:222    .text.can_rcv:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:228    .text.can_rcv:00000000 can_rcv
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:345    .text.can_rcv:0000007c $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:351    .text.K_line_RCV:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:357    .text.K_line_RCV:00000000 K_line_RCV
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:649    .text.K_line_RCV:0000017c $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:655    .text.K_line_send:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:661    .text.K_line_send:00000000 K_line_send
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:890    .text.K_line_send:0000013c $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:898    .text.K_line_slow_init:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:904    .text.K_line_slow_init:00000000 K_line_slow_init
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1260   .text.K_line_slow_init:00000244 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1270   .text.K_line_fast_init:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1276   .text.K_line_fast_init:00000000 K_line_fast_init
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1477   .text.K_line_fast_init:00000154 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1484   .rodata:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1494   .text.OBD_ecu_Init:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1500   .text.OBD_ecu_Init:00000000 OBD_ecu_Init
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1716   .text.OBD_Send_Recive_ecu:00000000 OBD_Send_Recive_ecu
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2465   .text.bus_off:00000000 bus_off
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1701   .text.OBD_ecu_Init:00000160 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1710   .text.OBD_Send_Recive_ecu:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1833   .text.OBD_Send_Recive_ecu:00000098 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2538   .bss.ecu_fail.1:00000000 ecu_fail.1
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1840   .text.OBD_Send_Recive:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:1846   .text.OBD_Send_Recive:00000000 OBD_Send_Recive
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2080   .text.OBD_Send_Recive:00000148 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2543   .bss.ecu_fail.0:00000000 ecu_fail.0
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2091   .text.OBD_Serial_Init:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2097   .text.OBD_Serial_Init:00000000 OBD_Serial_Init
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2263   .text.OBD_Serial_Init:0000010c $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2270   .text.can_Configuration:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2276   .text.can_Configuration:00000000 can_Configuration
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2453   .text.can_Configuration:0000011c $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2459   .text.bus_off:00000000 $t
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2530   .text.bus_off:00000050 $d
ARM GAS  C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s 			page 60


C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2539   .bss.ecu_fail.1:00000000 $d
C:\Users\Admin\AppData\Local\Temp\ccupIY6Z.s:2544   .bss.ecu_fail.0:00000000 $d

UNDEFINED SYMBOLS
CAN_Transmit
vTaskDelay
CAN_TransmitStatus
CAN_CancelTransmit
dif_count_obd
USART_GetFlagStatus
USART_SendData
setms_timecount_obd2
RCC_APB2PeriphClockCmd
GPIO_SetBits
GPIO_Init
RCC_APB1PeriphClockCmd
TIM_DeInit
TIM_TimeBaseInit
TIM_ClearFlag
TIM_ITConfig
TIM_Cmd
NVIC_PriorityGroupConfig
NVIC_Init
GPIO_ResetBits
GPIO_PinAFConfig
USART_Init
USART_ITConfig
USART_ClearFlag
USART_Cmd
CAN_DeInit
CAN_StructInit
CAN_Init
CAN_FilterInit
CAN_ITConfig
